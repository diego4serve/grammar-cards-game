import{a as M,f as j,d as or,c as lr}from"../chunks/BIg0sYn1.js";import{o as cr}from"../chunks/CJFNuX6i.js";import{h as ue,x as ts,W as ur,e as ss,o as dr,n as pr,B as c,t as hr,v as fr,w as Ns,y as as,i as St,a2 as mr,aO as gr,az as qs,c as $e,f as vs,aV as vr,s as br,aW as pa,R as yr,aX as wr,aM as Es,aY as _r,am as Os,aZ as xr,a_ as kr,aR as Sr,a$ as Ee,r as ha,p as fa,b0 as rs,q as Tr,b1 as Er,b2 as Pr,aL as Rr,d as Mr,a3 as jr,b3 as Ar,aS as Ir,k as Cr,al as Nr,b4 as qr,ai as Re,a8 as b,a9 as m,D as T,ab as d,a5 as Pe,a6 as B,aj as Me,aT as W,aU as le,C as Ps,a4 as bs}from"../chunks/xRZkEjnd.js";import{i as J,p as Or}from"../chunks/BtEb-poF.js";import{d as je,s as P,e as Dr}from"../chunks/CRTnJ9BO.js";import{r as Ds,s as Ls}from"../chunks/Df0M1iNH.js";function Se(s,e){return e}function Lr(s,e,t){for(var a=[],r=e.length,n,i=e.length,o=0;o<r;o++){let _=e[o];fa(_,()=>{if(n){if(n.pending.delete(_),n.done.add(_),n.pending.size===0){var x=s.outrogroups;ys(Es(n.done)),x.delete(n),x.size===0&&(s.outrogroups=null)}}else i-=1},!1)}if(i===0){var l=a.length===0&&t!==null;if(l){var h=t,f=h.parentNode;Rr(f),f.append(h),s.items.clear()}ys(e,!l)}else n={pending:new Set(e),done:new Set},(s.outrogroups??=new Set).add(n)}function ys(s,e=!0){for(var t=0;t<s.length;t++)Mr(s[t],e)}var zs;function de(s,e,t,a,r,n=null){var i=s,o=new Map,l=(e&pa)!==0;if(l){var h=s;i=ue?ts(ur(h)):h.appendChild(ss())}ue&&dr();var f=null,_=yr(()=>{var g=t();return wr(g)?g:g==null?[]:Es(g)}),x,v=!0;function k(){p.fallback=f,zr(p,x,i,e,a),f!==null&&(x.length===0?(f.f&Ee)===0?ha(f):(f.f^=Ee,dt(f,null,i)):fa(f,()=>{f=null}))}var S=pr(()=>{x=c(_);var g=x.length;let y=!1;if(ue){var I=hr(i)===fr;I!==(g===0)&&(i=Ns(),ts(i),as(!1),y=!0)}for(var C=new Set,E=$e,D=br(),N=0;N<g;N+=1){ue&&St.nodeType===mr&&St.data===gr&&(i=St,y=!0,as(!1));var z=x[N],F=a(z,N),q=v?null:o.get(F);q?(q.v&&qs(q.v,z),q.i&&qs(q.i,N),D&&E.unskip_effect(q.e)):(q=Br(o,v?i:zs??=ss(),z,F,N,r,e,t),v||(q.e.f|=Ee),o.set(F,q)),C.add(F)}if(g===0&&n&&!f&&(v?f=vs(()=>n(i)):(f=vs(()=>n(zs??=ss())),f.f|=Ee)),g>C.size&&vr(),ue&&g>0&&ts(Ns()),!v)if(D){for(const[Y,A]of o)C.has(Y)||E.skip_effect(A.e);E.oncommit(k),E.ondiscard(()=>{})}else k();y&&as(!0),c(_)}),p={effect:S,items:o,outrogroups:null,fallback:f};v=!1,ue&&(i=St)}function Ge(s){for(;s!==null&&(s.f&Er)===0;)s=s.next;return s}function zr(s,e,t,a,r){var n=(a&Pr)!==0,i=e.length,o=s.items,l=Ge(s.effect.first),h,f=null,_,x=[],v=[],k,S,p,g;if(n)for(g=0;g<i;g+=1)k=e[g],S=r(k,g),p=o.get(S).e,(p.f&Ee)===0&&(p.nodes?.a?.measure(),(_??=new Set).add(p));for(g=0;g<i;g+=1){if(k=e[g],S=r(k,g),p=o.get(S).e,s.outrogroups!==null)for(const q of s.outrogroups)q.pending.delete(p),q.done.delete(p);if((p.f&Ee)!==0)if(p.f^=Ee,p===l)dt(p,null,t);else{var y=f?f.next:l;p===s.effect.last&&(s.effect.last=p.prev),p.prev&&(p.prev.next=p.next),p.next&&(p.next.prev=p.prev),Ce(s,f,p),Ce(s,p,y),dt(p,y,t),f=p,x=[],v=[],l=Ge(f.next);continue}if((p.f&rs)!==0&&(ha(p),n&&(p.nodes?.a?.unfix(),(_??=new Set).delete(p))),p!==l){if(h!==void 0&&h.has(p)){if(x.length<v.length){var I=v[0],C;f=I.prev;var E=x[0],D=x[x.length-1];for(C=0;C<x.length;C+=1)dt(x[C],I,t);for(C=0;C<v.length;C+=1)h.delete(v[C]);Ce(s,E.prev,D.next),Ce(s,f,E),Ce(s,D,I),l=I,f=D,g-=1,x=[],v=[]}else h.delete(p),dt(p,l,t),Ce(s,p.prev,p.next),Ce(s,p,f===null?s.effect.first:f.next),Ce(s,f,p),f=p;continue}for(x=[],v=[];l!==null&&l!==p;)(h??=new Set).add(l),v.push(l),l=Ge(l.next);if(l===null)continue}(p.f&Ee)===0&&x.push(p),f=p,l=Ge(p.next)}if(s.outrogroups!==null){for(const q of s.outrogroups)q.pending.size===0&&(ys(Es(q.done)),s.outrogroups?.delete(q));s.outrogroups.size===0&&(s.outrogroups=null)}if(l!==null||h!==void 0){var N=[];if(h!==void 0)for(p of h)(p.f&rs)===0&&N.push(p);for(;l!==null;)(l.f&rs)===0&&l!==s.fallback&&N.push(l),l=Ge(l.next);var z=N.length;if(z>0){var F=(a&pa)!==0&&i===0?t:null;if(n){for(g=0;g<z;g+=1)N[g].nodes?.a?.measure();for(g=0;g<z;g+=1)N[g].nodes?.a?.fix()}Lr(s,N,F)}}n&&Tr(()=>{if(_!==void 0)for(p of _)p.nodes?.a?.apply()})}function Br(s,e,t,a,r,n,i,o){var l=(i&xr)!==0?(i&kr)===0?Sr(t,!1,!1):Os(t):null,h=(i&_r)!==0?Os(r):null;return{v:l,i:h,e:vs(()=>(n(e,l??t,h??r,o),()=>{s.delete(a)}))}}function dt(s,e,t){if(s.nodes)for(var a=s.nodes.start,r=s.nodes.end,n=e&&(e.f&Ee)===0?e.nodes.start:t;a!==null;){var i=jr(a);if(n.before(a),a===r)return;a=i}}function Ce(s,e,t){e===null?s.effect.first=t:e.next=t,t===null?s.effect.last=e:t.prev=e}const Bs=[...` 	
\r\fÂ \v\uFEFF`];function Wr(s,e,t){var a=s==null?"":""+s;if(e&&(a=a?a+" "+e:e),t){for(var r in t)if(t[r])a=a?a+" "+r:r;else if(a.length)for(var n=r.length,i=0;(i=a.indexOf(r,i))>=0;){var o=i+n;(i===0||Bs.includes(a[i-1]))&&(o===a.length||Bs.includes(a[o]))?a=(i===0?"":a.substring(0,i))+a.substring(o+1):i=o}}return a===""?null:a}function Ur(s,e){return s==null?null:String(s)}function ft(s,e,t,a,r,n){var i=s.__className;if(ue||i!==t||i===void 0){var o=Wr(t,a,n);(!ue||o!==s.getAttribute("class"))&&(o==null?s.removeAttribute("class"):s.className=o),s.__className=t}else if(n&&r!==n)for(var l in n){var h=!!n[l];(r==null||h!==!!r[l])&&s.classList.toggle(l,h)}return n}function Vr(s,e,t,a){var r=s.__style;if(ue||r!==e){var n=Ur(e);(!ue||n!==s.getAttribute("style"))&&(n==null?s.removeAttribute("style"):s.style.cssText=n),s.__style=e}return a}function Ws(s,e,t=e){var a=new WeakSet;Ar(s,"input",async r=>{var n=r?s.defaultValue:s.value;if(n=ns(s)?is(n):n,t(n),$e!==null&&a.add($e),await Ir(),n!==(n=e())){var i=s.selectionStart,o=s.selectionEnd,l=s.value.length;if(s.value=n??"",o!==null){var h=s.value.length;i===o&&o===l&&h>l?(s.selectionStart=h,s.selectionEnd=h):(s.selectionStart=i,s.selectionEnd=Math.min(o,h))}}}),(ue&&s.defaultValue!==s.value||Cr(e)==null&&s.value)&&(t(ns(s)?is(s.value):s.value),$e!==null&&a.add($e)),Nr(()=>{var r=e();if(s===document.activeElement){var n=qr??$e;if(a.has(n))return}ns(s)&&r===is(s.value)||s.type==="date"&&!r&&!s.value||r!==s.value&&(s.value=r??"")})}function ns(s){var e=s.type;return e==="number"||e==="range"}function is(s){return s===""?null:+s}var Fr=j('<input type="text" placeholder="sk-ant-..." class="api-input svelte-1s08ceg"/>'),Hr=j('<input type="password" placeholder="sk-ant-..." class="api-input svelte-1s08ceg"/>'),$r=j('<div class="setup svelte-1s08ceg"><p class="subtitle svelte-1s08ceg">Aprende gramatica inglesa armando frases con tarjetas</p> <div class="card svelte-1s08ceg"><p class="instructions svelte-1s08ceg">Ingresa tu API key de Anthropic para comenzar:</p> <form class="svelte-1s08ceg"><div class="input-wrapper svelte-1s08ceg"><!> <button type="button" class="toggle-btn svelte-1s08ceg"> </button></div> <button type="submit" class="submit-btn svelte-1s08ceg">Guardar y continuar</button></form> <p class="note svelte-1s08ceg">Tu key se guarda solo en este navegador (localStorage).</p></div> <p class="footer svelte-1s08ceg">Hecho con ðŸ§¡ por <a class="author-link svelte-1s08ceg" href="https://www.linkedin.com/in/diegofdom/" target="_blank" rel="noopener noreferrer">Diego Dominguez</a></p></div>');function Jr(s,e){Re(e,!0);let t=W(""),a=W(!1);function r(){const S=c(t).trim();S&&e.onsave(S)}var n=$r(),i=b(m(n),2),o=b(m(i),2),l=m(o),h=m(l);{var f=S=>{var p=Fr();Ds(p),Ws(p,()=>c(t),g=>T(t,g)),M(S,p)},_=S=>{var p=Hr();Ds(p),Ws(p,()=>c(t),g=>T(t,g)),M(S,p)};J(h,S=>{c(a)?S(f):S(_,!1)})}var x=b(h,2);x.__click=()=>T(a,!c(a));var v=m(x,!0);d(x),d(l);var k=b(l,2);d(o),Pe(2),d(i),Pe(2),d(n),B(S=>{P(v,c(a)?"Ocultar":"Mostrar"),k.disabled=S},[()=>!c(t).trim()]),Dr("submit",o,r),M(s,n),Me()}je(["click"]);const ma=[{id:"random",label:"Aleatorio",description:"Temas variados en cada ejercicio"},{id:"daily routine",label:"Rutina diaria",description:"Actividades del dÃ­a a dÃ­a"},{id:"travel",label:"Viajes",description:"Aeropuertos, hoteles, destinos"},{id:"work",label:"Trabajo",description:"Oficina, tareas, compaÃ±eros"},{id:"food",label:"Comida",description:"Restaurantes, recetas, cocina"},{id:"sports",label:"Deportes",description:"Partidos, entrenamiento, equipos"},{id:"shopping",label:"Compras",description:"Tiendas, precios, productos"},{id:"family",label:"Familia",description:"Padres, hijos, reuniones"},{id:"health",label:"Salud",description:"Doctor, ejercicio, bienestar"},{id:"technology",label:"TecnologÃ­a",description:"Apps, gadgets, internet"},{id:"hobbies",label:"Hobbies",description:"MÃºsica, lectura, juegos"},{id:"weather",label:"Clima",description:"Sol, lluvia, estaciones"},{id:"school",label:"Escuela",description:"Clases, exÃ¡menes, campus"},{id:"nature",label:"Naturaleza",description:"Animales, plantas, paisajes"}],Qr=[{id:"dev meetings & scrum",label:"Dev & Scrum",description:"Sprints, standups, PRs, deploys"},{id:"software engineering",label:"Software Dev",description:"CÃ³digo, arquitectura, cloud, APIs"}],Xr=ma.filter(s=>s.id!=="random").map(s=>s.id);var Gr=j("<button> </button>"),Kr=j("<button> </button>"),Yr=j('<button class="tense-badge svelte-ro4c24"> </button>'),Zr=j('<div class="level-card svelte-ro4c24" role="group"><button class="level-header svelte-ro4c24"><span class="level-label svelte-ro4c24"> </span> <span class="level-desc svelte-ro4c24"> </span></button> <div class="tense-badges svelte-ro4c24"><!> <button class="tense-badge question-badge svelte-ro4c24">Questions</button></div></div>'),en=j('<div class="selector svelte-ro4c24"><p class="intro svelte-ro4c24">Elige un tema y un nivel para empezar. Si quieres practicar un tiempo en particular, toca el badge.</p> <div class="topic-section svelte-ro4c24"><div class="topic-chips svelte-ro4c24"></div> <div class="specialized-section svelte-ro4c24"><div class="specialized-line svelte-ro4c24"><span class="specialized-label svelte-ro4c24">Especializados</span></div> <div class="topic-chips svelte-ro4c24"></div></div></div> <div class="levels svelte-ro4c24"></div> <button class="glossary-btn svelte-ro4c24"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg> Glosario gramatical</button> <button class="change-key-btn svelte-ro4c24">Cambiar API key</button> <p class="footer svelte-ro4c24">Hecho con <button class="heart-link svelte-ro4c24">ðŸ§¡</button> por <a class="author-link svelte-ro4c24" href="https://www.linkedin.com/in/diegofdom/" target="_blank" rel="noopener noreferrer">Diego Dominguez</a></p></div>');function tn(s,e){Re(e,!0);let t=W("random");const a=[{key:"beginner",label:"Principiante",tenses:["Present simple","Present continuous","Going to","Simple past"],description:"Presente simple, presente continuo, futuro con going to, pasado simple."},{key:"intermediate",label:"Intermedio",tenses:["Present perfect","Past continuous","Will future","First conditional","Modals"],description:"Presente perfecto, pasado continuo, futuro con will, primer condicional, verbos modales."},{key:"advanced",label:"Avanzado",tenses:["Past perfect","Third conditional","Passive voice","Reported speech","Subjunctive"],description:"Pasado perfecto, tercer condicional, voz pasiva, estilo indirecto, subjuntivo."}];function r(p,g,y){p.stopPropagation(),e.onselect(g,c(t),y)}function n(p,g){p.stopPropagation(),e.onselect(g,c(t),void 0,!0)}var i=en(),o=b(m(i),2),l=m(o);de(l,21,()=>ma,Se,(p,g)=>{var y=Gr();let I;y.__click=()=>T(t,c(g).id,!0);var C=m(y,!0);d(y),B(()=>{I=ft(y,1,"topic-chip svelte-ro4c24",null,I,{active:c(t)===c(g).id}),Ls(y,"title",c(g).description),P(C,c(g).label)}),M(p,y)}),d(l);var h=b(l,2),f=b(m(h),2);de(f,21,()=>Qr,Se,(p,g)=>{var y=Kr();let I;y.__click=()=>T(t,c(g).id,!0);var C=m(y,!0);d(y),B(()=>{I=ft(y,1,"topic-chip specialized svelte-ro4c24",null,I,{active:c(t)===c(g).id}),Ls(y,"title",c(g).description),P(C,c(g).label)}),M(p,y)}),d(f),d(h),d(o);var _=b(o,2);de(_,21,()=>a,Se,(p,g)=>{var y=Zr(),I=m(y);I.__click=()=>e.onselect(c(g).key,c(t));var C=m(I),E=m(C,!0);d(C);var D=b(C,2),N=m(D,!0);d(D),d(I);var z=b(I,2),F=m(z);de(F,17,()=>c(g).tenses,Se,(Y,A)=>{var O=Yr();O.__click=H=>r(H,c(g).key,c(A).toLowerCase());var G=m(O,!0);d(O),B(()=>P(G,c(A))),M(Y,O)});var q=b(F,2);q.__click=Y=>n(Y,c(g).key),d(z),d(y),B(()=>{P(E,c(g).label),P(N,c(g).description)}),M(p,y)}),d(_);var x=b(_,2);x.__click=function(...p){e.onglossary?.apply(this,p)};var v=b(x,2);v.__click=function(...p){e.onchangekey?.apply(this,p)};var k=b(v,2),S=b(m(k));S.__click=function(...p){e.ondedication?.apply(this,p)},Pe(2),d(k),d(i),M(s,i),Me()}je(["click"]);const sn={level:"Fundamentos",tenses:[{name:"Personal Pronouns - Pronombres personales",description:"Los pronombres reemplazan al nombre del sujeto en la oraciÃ³n.",example:"I am a student. / She likes music. / They are playing.",exampleEs:"Yo soy estudiante. / A ella le gusta la mÃºsica. / Ellos estÃ¡n jugando.",structure:"I (yo) Â· you (tÃº/usted) Â· he (Ã©l) Â· she (ella) Â· it (ello) Â· we (nosotros) Â· they (ellos/ellas)",tip:'"You" sirve para tÃº, usted, ustedes y vosotros. "It" se usa para cosas y animales.'},{name:'Verb "to be" - Verbo "ser/estar"',description:"El verbo mÃ¡s importante del inglÃ©s. Sirve para describir, identificar y ubicar.",example:"I am happy. / She is a doctor. / We are at home.",exampleEs:"Yo estoy feliz. / Ella es doctora. / Nosotros estamos en casa.",structure:"I am Â· you are Â· he/she/it is Â· we are Â· they are",tip:"Formas cortas: I'm, you're, he's, she's, it's, we're, they're. NegaciÃ³n: am not, isn't, aren't."},{name:"Articles - ArtÃ­culos",description:"Palabras que van antes del sustantivo para indicar si es especÃ­fico o general.",example:"The cat is on the table. / I have a dog. / She is an artist.",exampleEs:"El gato estÃ¡ en la mesa. / Tengo un perro. / Ella es una artista.",structure:"the (el/la/los/las) Â· a (un/una antes de consonante) Â· an (un/una antes de vocal)",tip:'"The" = algo especÃ­fico. "A/an" = algo general. No se usa artÃ­culo para cosas en general: "I like music" (no "the music").'},{name:"Regular Verbs - Verbos regulares",description:"Verbos que siguen el patrÃ³n regular: se les agrega -ed en pasado y participio.",example:"I work every day. / She played yesterday. / They have finished.",exampleEs:"Trabajo todos los dÃ­as. / Ella jugÃ³ ayer. / Ellos han terminado.",structure:"",tip:"Reglas: verbo+ed (worked). Termina en -e â†’ solo -d (lived). Consonante+y â†’ ied (studied). CVC corto â†’ dobla consonante (stopped).",table:{headers:["Verb","Past","EspaÃ±ol"],rows:[["agree","agreed","estar de acuerdo"],["answer","answered","responder"],["arrive","arrived","llegar"],["ask","asked","preguntar"],["believe","believed","creer"],["call","called","llamar"],["carry","carried","cargar"],["change","changed","cambiar"],["clean","cleaned","limpiar"],["close","closed","cerrar"],["complete","completed","completar"],["cook","cooked","cocinar"],["create","created","crear"],["cry","cried","llorar"],["dance","danced","bailar"],["decide","decided","decidir"],["deliver","delivered","entregar"],["describe","described","describir"],["design","designed","diseÃ±ar"],["develop","developed","desarrollar"],["enjoy","enjoyed","disfrutar"],["explain","explained","explicar"],["finish","finished","terminar"],["fix","fixed","arreglar"],["follow","followed","seguir"],["help","helped","ayudar"],["imagine","imagined","imaginar"],["improve","improved","mejorar"],["invite","invited","invitar"],["jump","jumped","saltar"],["laugh","laughed","reÃ­r"],["learn","learned","aprender"],["like","liked","gustar"],["listen","listened","escuchar"],["live","lived","vivir"],["look","looked","mirar"],["love","loved","amar"],["manage","managed","gestionar"],["miss","missed","extraÃ±ar"],["move","moved","mover"],["need","needed","necesitar"],["offer","offered","ofrecer"],["open","opened","abrir"],["order","ordered","ordenar"],["organize","organized","organizar"],["plan","planned","planear"],["play","played","jugar"],["practice","practiced","practicar"],["prepare","prepared","preparar"],["promise","promised","prometer"],["pull","pulled","jalar"],["push","pushed","empujar"],["rain","rained","llover"],["relax","relaxed","relajarse"],["remember","remembered","recordar"],["return","returned","regresar"],["smile","smiled","sonreÃ­r"],["start","started","empezar"],["stop","stopped","parar"],["study","studied","estudiar"],["suggest","suggested","sugerir"],["talk","talked","hablar"],["travel","traveled","viajar"],["try","tried","intentar"],["turn","turned","girar"],["use","used","usar"],["visit","visited","visitar"],["wait","waited","esperar"],["walk","walked","caminar"],["want","wanted","querer"],["wash","washed","lavar"],["watch","watched","ver/mirar"],["work","worked","trabajar"],["worry","worried","preocuparse"]]}},{name:"Irregular Verbs - Verbos irregulares",description:"Verbos que NO siguen el patrÃ³n -ed. Debes memorizarlos.",example:"I go to school. / She went home. / They have gone.",exampleEs:"Voy a la escuela. / Ella fue a casa. / Ellos se han ido.",structure:"",tip:'No hay regla: hay que aprenderlos. Algunos no cambian: putâ†’putâ†’put, cutâ†’cutâ†’cut. "Read" se escribe igual pero cambia pronunciaciÃ³n: /riËd/ â†’ /rÉ›d/.',table:{headers:["Base","Past","Participle","EspaÃ±ol"],rows:[["be","was/were","been","ser/estar"],["become","became","become","convertirse"],["begin","began","begun","comenzar"],["bite","bit","bitten","morder"],["blow","blew","blown","soplar"],["break","broke","broken","romper"],["bring","brought","brought","traer"],["build","built","built","construir"],["buy","bought","bought","comprar"],["catch","caught","caught","atrapar"],["choose","chose","chosen","elegir"],["come","came","come","venir"],["cost","cost","cost","costar"],["cut","cut","cut","cortar"],["do","did","done","hacer"],["draw","drew","drawn","dibujar"],["drink","drank","drunk","beber"],["drive","drove","driven","conducir"],["eat","ate","eaten","comer"],["fall","fell","fallen","caer"],["feed","fed","fed","alimentar"],["feel","felt","felt","sentir"],["find","found","found","encontrar"],["fly","flew","flown","volar"],["forget","forgot","forgotten","olvidar"],["forgive","forgave","forgiven","perdonar"],["get","got","gotten","obtener"],["give","gave","given","dar"],["go","went","gone","ir"],["grow","grew","grown","crecer"],["hang","hung","hung","colgar"],["have","had","had","tener"],["hear","heard","heard","oÃ­r"],["hide","hid","hidden","esconder"],["hit","hit","hit","golpear"],["hold","held","held","sostener"],["keep","kept","kept","mantener"],["know","knew","known","saber"],["lead","led","led","liderar"],["leave","left","left","irse/dejar"],["lend","lent","lent","prestar"],["let","let","let","permitir"],["lie","lay","lain","acostarse"],["lose","lost","lost","perder"],["make","made","made","hacer/fabricar"],["mean","meant","meant","significar"],["pay","paid","paid","pagar"],["put","put","put","poner"],["read","read","read","leer"],["ride","rode","ridden","montar"],["rise","rose","risen","levantarse"],["run","ran","run","correr"],["say","said","said","decir"],["see","saw","seen","ver"],["sell","sold","sold","vender"],["send","sent","sent","enviar"],["set","set","set","fijar"],["shake","shook","shaken","sacudir"],["show","showed","shown","mostrar"],["shut","shut","shut","cerrar"],["sing","sang","sung","cantar"],["sit","sat","sat","sentarse"],["sleep","slept","slept","dormir"],["speak","spoke","spoken","hablar"],["spend","spent","spent","gastar/pasar tiempo"],["stand","stood","stood","pararse"],["steal","stole","stolen","robar"],["swim","swam","swum","nadar"],["take","took","taken","tomar"],["teach","taught","taught","enseÃ±ar"],["tell","told","told","contar/decir"],["think","thought","thought","pensar"],["throw","threw","thrown","lanzar"],["understand","understood","understood","entender"],["wake","woke","woken","despertar"],["wear","wore","worn","vestir/usar"],["win","won","won","ganar"],["write","wrote","written","escribir"]]}},{name:"Question Words - Palabras interrogativas",description:"Palabras que se usan al inicio de preguntas para pedir informaciÃ³n especÃ­fica.",example:"What is your name? / Where do you live? / Why are you late?",exampleEs:"Â¿CuÃ¡l es tu nombre? / Â¿DÃ³nde vives? / Â¿Por quÃ© llegas tarde?",structure:"What (quÃ©) Â· Where (dÃ³nde) Â· When (cuÃ¡ndo) Â· Who (quiÃ©n) Â· Why (por quÃ©) Â· How (cÃ³mo) Â· Which (cuÃ¡l) Â· How many (cuÃ¡ntos) Â· How much (cuÃ¡nto)",tip:'La estructura es: Question word + auxiliar + sujeto + verbo. Ej: "Where do you work?"'},{name:"Prepositions of Time - Preposiciones de tiempo",description:"Palabras que indican cuÃ¡ndo ocurre algo.",example:"I wake up at 7. / She was born in 1990. / We travel on Mondays.",exampleEs:"Me despierto a las 7. / Ella naciÃ³ en 1990. / Viajamos los lunes.",structure:"at (hora): at 3 PM, at night Â· in (mes/aÃ±o/perÃ­odo): in May, in 2020, in the morning Â· on (dÃ­a/fecha): on Monday, on July 4th",tip:'AT = hora/momento puntual. IN = perÃ­odo largo. ON = dÃ­a especÃ­fico. "At night" pero "in the morning/afternoon/evening".'},{name:"Prepositions of Place - Preposiciones de lugar",description:"Palabras que indican dÃ³nde estÃ¡ algo o alguien.",example:"The book is on the table. / She is at school. / They live in Paris.",exampleEs:"El libro estÃ¡ en la mesa. / Ella estÃ¡ en la escuela. / Ellos viven en ParÃ­s.",structure:"in (dentro): in the box, in Paris Â· on (sobre): on the table, on the wall Â· at (punto): at school, at home Â· under (debajo) Â· next to (al lado) Â· between (entre) Â· behind (detrÃ¡s) Â· in front of (enfrente de)",tip:"IN = dentro de un espacio. ON = sobre una superficie. AT = un punto/lugar especÃ­fico."},{name:"Possessive Adjectives - Adjetivos posesivos",description:"Indican a quiÃ©n pertenece algo. Van antes del sustantivo.",example:"This is my book. / Her cat is black. / Their house is big.",exampleEs:"Este es mi libro. / Su gato (de ella) es negro. / Su casa (de ellos) es grande.",structure:"my (mi) Â· your (tu/su) Â· his (su, de Ã©l) Â· her (su, de ella) Â· its (su, de ello) Â· our (nuestro) Â· their (su, de ellos)",tip:`No confundas: "your" (tu) con "you're" (tÃº eres), ni "their" (su) con "they're" (ellos son) o "there" (allÃ­).`},{name:"Demonstratives - Demostrativos",description:"Palabras que seÃ±alan algo cercano o lejano, en singular o plural.",example:"This is my pen. / That is your car. / These are delicious. / Those are expensive.",exampleEs:"Este es mi bolÃ­grafo. / Ese es tu carro. / Estos estÃ¡n deliciosos. / Esos son caros.",structure:"this (este/esta, cerca singular) Â· that (ese/esa, lejos singular) Â· these (estos/estas, cerca plural) Â· those (esos/esas, lejos plural)",tip:'"This/these" = cerca de ti. "That/those" = lejos de ti. TambiÃ©n se usan para tiempo: "this week" (esta semana), "that day" (ese dÃ­a).'},{name:"Common Adjectives - Adjetivos comunes",description:"Palabras que describen sustantivos. En inglÃ©s van ANTES del sustantivo y no cambian en plural.",example:"She has a big house. / The small cats are cute. / It is an old book.",exampleEs:"Ella tiene una casa grande. / Los gatos pequeÃ±os son lindos. / Es un libro viejo.",structure:"bigâ†”small (grandeâ†”pequeÃ±o) Â· hotâ†”cold (calienteâ†”frÃ­o) Â· oldâ†”new (viejoâ†”nuevo) Â· goodâ†”bad (buenoâ†”malo) Â· happyâ†”sad (felizâ†”triste) Â· fastâ†”slow (rÃ¡pidoâ†”lento) Â· easyâ†”hard (fÃ¡cilâ†”difÃ­cil) Â· longâ†”short (largoâ†”corto) Â· beautifulâ†”ugly (bonitoâ†”feo) Â· expensiveâ†”cheap (caroâ†”barato)",tip:'En inglÃ©s los adjetivos NO tienen plural: "big houses" (no "bigs houses"). Siempre van antes del sustantivo: "a red car" (no "a car red").'},{name:"Numbers - NÃºmeros",description:"Los nÃºmeros bÃ¡sicos en inglÃ©s del 1 al 20 y las decenas.",example:"I have two brothers. / She is twenty-five years old. / There are fifty students.",exampleEs:"Tengo dos hermanos. / Ella tiene veinticinco aÃ±os. / Hay cincuenta estudiantes.",structure:"1 one Â· 2 two Â· 3 three Â· 4 four Â· 5 five Â· 6 six Â· 7 seven Â· 8 eight Â· 9 nine Â· 10 ten Â· 11 eleven Â· 12 twelve Â· 13 thirteen Â· 14 fourteen Â· 15 fifteen Â· 16 sixteen Â· 17 seventeen Â· 18 eighteen Â· 19 nineteen Â· 20 twenty Â· 30 thirty Â· 40 forty Â· 50 fifty Â· 60 sixty Â· 70 seventy Â· 80 eighty Â· 90 ninety Â· 100 one hundred",tip:'Del 13 al 19 terminan en -teen. Las decenas terminan en -ty. Para compuestos: twenty-one (21), thirty-five (35). Cuidado: "forty" (no "fourty").'},{name:"Days & Months - DÃ­as y meses",description:"En inglÃ©s los dÃ­as y meses SIEMPRE se escriben con mayÃºscula.",example:"I work on Monday. / My birthday is in July. / See you on Friday!",exampleEs:"Trabajo el lunes. / Mi cumpleaÃ±os es en julio. / Â¡Nos vemos el viernes!",structure:"Monday (lunes) Â· Tuesday (martes) Â· Wednesday (miÃ©rcoles) Â· Thursday (jueves) Â· Friday (viernes) Â· Saturday (sÃ¡bado) Â· Sunday (domingo) Â·Â· January (enero) Â· February (febrero) Â· March (marzo) Â· April (abril) Â· May (mayo) Â· June (junio) Â· July (julio) Â· August (agosto) Â· September (septiembre) Â· October (octubre) Â· November (noviembre) Â· December (diciembre)",tip:'Usa "on" con dÃ­as: "on Monday". Usa "in" con meses: "in July". Siempre con mayÃºscula: "Friday" (no "friday").'},{name:"Adverbs of Frequency - Adverbios de frecuencia",description:'Indican con quÃ© frecuencia ocurre algo. Van entre el sujeto y el verbo (excepto con "to be").',example:"I always drink coffee. / She never eats meat. / They usually arrive early.",exampleEs:"Siempre tomo cafÃ©. / Ella nunca come carne. / Ellos usualmente llegan temprano.",structure:"always (siempre, 100%) Â· usually (usualmente, 90%) Â· often (a menudo, 70%) Â· sometimes (a veces, 50%) Â· rarely (raramente, 10%) Â· never (nunca, 0%)",tip:'Van ANTES del verbo: "I always eat". Pero DESPUÃ‰S de "to be": "She is always happy" (no "She always is happy").'},{name:"Basic Connectors - Conectores bÃ¡sicos",description:"Palabras que unen ideas en una oraciÃ³n.",example:"I like tea and coffee. / She is tired but happy. / Study hard or you will fail.",exampleEs:"Me gusta el tÃ© y el cafÃ©. / Ella estÃ¡ cansada pero feliz. / Estudia duro o reprobarÃ¡s.",structure:"and (y) Â· but (pero) Â· or (o) Â· because (porque) Â· so (asÃ­ que/entonces) Â· also (tambiÃ©n) Â· however (sin embargo) Â· then (entonces/luego)",tip:'"Because" responde a "why": "I stayed home because it was raining." "So" indica resultado: "It was raining, so I stayed home."'}]},mt=[{level:"Principiante",tenses:[{name:"Present Simple - Presente simple",description:"Acciones habituales, rutinas o verdades generales.",example:"She works every day.",exampleEs:"Ella trabaja todos los dÃ­as.",structure:"Sujeto + verbo (base / +s en 3a persona)",tip:'Usa "do/does" para preguntas y negaciones.'},{name:"Present Continuous - Presente continuo",description:"Acciones que ocurren en este momento o situaciones temporales.",example:"They are playing in the park.",exampleEs:"Ellos estÃ¡n jugando en el parque.",structure:"Sujeto + am/is/are + verbo-ing",tip:"No se usa con verbos de estado (know, want, like)."},{name:'Going to (Future) - Futuro con "ir a"',description:"Planes o intenciones futuras, o predicciones basadas en evidencia.",example:"I am going to travel next month.",exampleEs:"Voy a viajar el prÃ³ximo mes.",structure:"Sujeto + am/is/are + going to + verbo base",tip:"Indica que ya se ha decidido o hay evidencia visible."},{name:"Simple Past - Pasado simple",description:"Acciones completadas en el pasado.",example:"We visited the museum yesterday.",exampleEs:"Visitamos el museo ayer.",structure:"Sujeto + verbo en pasado (-ed / irregular)",tip:'Usa "did" para preguntas y negaciones. Cuidado con los verbos irregulares (goâ†’went, eatâ†’ate).'}]},{level:"Intermedio",tenses:[{name:"Present Perfect - Presente perfecto",description:"Acciones pasadas con conexion al presente, o experiencias de vida.",example:"I have visited three countries.",exampleEs:"He visitado tres paÃ­ses.",structure:"Sujeto + have/has + participio pasado",tip:'Usa "ever", "never", "already", "yet", "just" como pistas.'},{name:"Past Continuous - Pasado continuo",description:"Acciones en progreso en un momento del pasado, o acciones interrumpidas.",example:"She was reading when the phone rang.",exampleEs:"Ella estaba leyendo cuando sonÃ³ el telÃ©fono.",structure:"Sujeto + was/were + verbo-ing",tip:'Frecuentemente se combina con Simple Past usando "when" o "while".'},{name:'Will (Future) - Futuro con "will"',description:"Decisiones espontaneas, predicciones, promesas u ofertas.",example:"I will help you with that.",exampleEs:"Te ayudarÃ© con eso.",structure:"Sujeto + will + verbo base",tip:'A diferencia de "going to", indica decision en el momento o prediccion sin evidencia.'},{name:"First Conditional - Primer condicional",description:"Situaciones posibles/probables en el futuro.",example:"If it rains, we will stay home.",exampleEs:"Si llueve, nos quedaremos en casa.",structure:"If + present simple, will + verbo base",tip:'La condicion es real y posible. No uses "will" en la clausula con "if".'},{name:"Modals - Verbos modales (can, must, should)",description:"Expresan habilidad, obligacion o consejo.",example:"You should study more. / She can swim very well.",exampleEs:"DeberÃ­as estudiar mÃ¡s. / Ella sabe nadar muy bien.",structure:'Sujeto + modal + verbo base (sin "to")',tip:"Can = poder/saber, must = deber (obligacion fuerte), should = deberia (consejo)."}]},{level:"Avanzado",tenses:[{name:"Past Perfect - Pasado perfecto",description:"Una accion que ocurrio antes de otra accion en el pasado.",example:"She had already left when I arrived.",exampleEs:"Ella ya se habÃ­a ido cuando lleguÃ©.",structure:"Sujeto + had + participio pasado",tip:'Es "el pasado del pasado". Usa "already", "just", "never", "before" como pistas.'},{name:"Third Conditional - Tercer condicional",description:"Situaciones hipoteticas del pasado (que no ocurrieron).",example:"If I had studied, I would have passed.",exampleEs:"Si hubiera estudiado, habrÃ­a aprobado.",structure:"If + past perfect, would have + participio",tip:"Expresa arrepentimiento o especulacion sobre el pasado. Es irreal."},{name:"Passive Voice - Voz pasiva",description:"Cuando el foco esta en la accion o el receptor, no en quien la realiza.",example:"The book was written by a famous author.",exampleEs:"El libro fue escrito por un autor famoso.",structure:"Sujeto (receptor) + be + participio pasado",tip:'Usa "by" para indicar quien realiza la accion (agente), pero es opcional.'},{name:"Passive Voice: Present Simple - Voz pasiva: Presente simple",description:"Voz pasiva para acciones habituales o verdades generales.",example:"The reports are reviewed every Monday.",exampleEs:"Los informes son revisados cada lunes.",structure:"Sujeto + am/is/are + participio pasado",tip:'Usa "am/is/are" como auxiliar. Ej: "English is spoken here."'},{name:"Passive Voice: Present Continuous - Voz pasiva: Presente continuo",description:"Voz pasiva para acciones en progreso ahora mismo.",example:"The house is being painted this week.",exampleEs:"La casa estÃ¡ siendo pintada esta semana.",structure:"Sujeto + am/is/are + being + participio pasado",tip:'Agrega "being" entre el auxiliar y el participio. Ej: "is being repaired".'},{name:"Passive Voice: Past Simple - Voz pasiva: Pasado simple",description:"Voz pasiva para acciones completadas en el pasado.",example:"The letter was sent yesterday.",exampleEs:"La carta fue enviada ayer.",structure:"Sujeto + was/were + participio pasado",tip:'Usa "was/were" como auxiliar. Ej: "The cake was made by my grandmother."'},{name:"Passive Voice: Past Continuous - Voz pasiva: Pasado continuo",description:"Voz pasiva para acciones en progreso en un momento del pasado.",example:"The road was being repaired when we arrived.",exampleEs:"La carretera estaba siendo reparada cuando llegamos.",structure:"Sujeto + was/were + being + participio pasado",tip:'Similar al present continuous pasivo pero en pasado: "was/were being + participio".'},{name:"Passive Voice: Present Perfect - Voz pasiva: Presente perfecto",description:"Voz pasiva para acciones pasadas con conexion al presente.",example:"The homework has been finished already.",exampleEs:"La tarea ya ha sido terminada.",structure:"Sujeto + have/has + been + participio pasado",tip:'Combina "have/has been" + participio. Ej: "has been sold".'},{name:"Passive Voice: Past Perfect - Voz pasiva: Pasado perfecto",description:"Voz pasiva para acciones que ocurrieron antes de otra accion pasada.",example:"The dinner had been prepared before the guests arrived.",exampleEs:"La cena habÃ­a sido preparada antes de que llegaran los invitados.",structure:"Sujeto + had + been + participio pasado",tip:'Usa "had been" + participio. Es el pasado del pasado en voz pasiva.'},{name:'Passive Voice: Will (Future) - Voz pasiva: Futuro con "will"',description:"Voz pasiva para acciones futuras.",example:"The winners will be announced tomorrow.",exampleEs:"Los ganadores serÃ¡n anunciados maÃ±ana.",structure:"Sujeto + will + be + participio pasado",tip:'Usa "will be" + participio. Ej: "will be delivered", "will be invited".'},{name:'Passive Voice: Going to (Future) - Voz pasiva: Futuro con "ir a"',description:"Voz pasiva para planes o intenciones futuras.",example:"The park is going to be renovated next year.",exampleEs:"El parque va a ser renovado el prÃ³ximo aÃ±o.",structure:"Sujeto + am/is/are + going to + be + participio pasado",tip:'Agrega "be" antes del participio: "is going to be cleaned".'},{name:"Passive Voice: Modal Verb - Voz pasiva: Verbo modal",description:"Voz pasiva combinada con un verbo modal (can, must, should, could, might).",example:"This report must be finished by Friday.",exampleEs:"Este informe debe ser terminado para el viernes.",structure:"Sujeto + modal + be + participio pasado",tip:'El modal va primero, luego "be" + participio. Ej: "can be done", "should be reviewed", "must be sent".'},{name:"Reported Speech - Discurso indirecto",description:"Relatar lo que alguien dijo, cambiando tiempos verbales.",example:"He said that he was tired.",exampleEs:"Ã‰l dijo que estaba cansado.",structure:"Sujeto + said/told + (that) + oracion con tiempo retrocedido",tip:'Los tiempos "retroceden": presentâ†’past, pastâ†’past perfect, willâ†’would.'},{name:"Subjunctive - Subjuntivo",description:"Deseos, sugerencias o situaciones hipoteticas.",example:"I wish I were taller. / He suggested that she study harder.",exampleEs:"DesearÃ­a ser mÃ¡s alto. / Ã‰l sugiriÃ³ que ella estudie mÃ¡s.",structure:"Wish + past simple / suggest + (that) + verbo base",tip:'Con "wish", usa "were" para todas las personas (no "was").'}]}],ga={name:"Interrogative (Questions) - Interrogativo (Preguntas)",description:"Las preguntas en inglÃ©s se forman invirtiendo el orden del sujeto y el auxiliar. Si no hay auxiliar, se agrega do/does/did.",example:"Do you speak English? / Is she working? / Have they finished?",exampleEs:"Â¿Hablas inglÃ©s? / Â¿EstÃ¡ ella trabajando? / Â¿Han terminado ellos?",structure:"Auxiliar + sujeto + verbo (Do you like...? / Is she...? / Can they...?)",tip:"Identifica el auxiliar del tiempo verbal (do/does, did, is/are, have/has, will, can...) y colÃ³calo antes del sujeto. Para Wh-questions: What/Where/Why + auxiliar + sujeto + verbo."},U={"present simple":{name:"Questions: Present Simple - Preguntas: Presente simple",description:"Se usa do/does como auxiliar para formar preguntas en presente simple.",structure:"Do/Does + sujeto + verbo base",example:"Do you like coffee? / Does she work here?",exampleEs:"Â¿Te gusta el cafÃ©? / Â¿Ella trabaja aquÃ­?",tip:'Usa "do" para I/you/we/they y "does" para he/she/it. El verbo principal va en forma base (sin -s).'},"present continuous":{name:"Questions: Present Continuous - Preguntas: Presente continuo",description:"Se invierte el auxiliar am/is/are con el sujeto.",structure:"Am/Is/Are + sujeto + verbo-ing",example:"Are you studying? / Is he coming?",exampleEs:"Â¿EstÃ¡s estudiando? / Â¿Ã‰l viene?",tip:"El auxiliar ya existe en la oraciÃ³n, solo hay que moverlo al inicio."},"going to":{name:'Questions: Going to (Future) - Preguntas: Futuro con "ir a"',description:'Se invierte am/is/are con el sujeto, manteniendo "going to".',structure:"Am/Is/Are + sujeto + going to + verbo base",example:"Are you going to travel? / Is she going to study?",exampleEs:"Â¿Vas a viajar? / Â¿Ella va a estudiar?",tip:'No cambies "going to" â€” solo mueve am/is/are al inicio.'},"simple past":{name:"Questions: Simple Past - Preguntas: Pasado simple",description:'Se usa "did" como auxiliar. El verbo principal vuelve a forma base.',structure:"Did + sujeto + verbo base",example:"Did you go? / Did she eat breakfast?",exampleEs:"Â¿Fuiste? / Â¿Ella desayunÃ³?",tip:'Cuidado: el verbo NO va en pasado. "Did you went" es incorrecto â†’ "Did you go".'},"present perfect":{name:"Questions: Present Perfect - Preguntas: Presente perfecto",description:"Se invierte have/has con el sujeto.",structure:"Have/Has + sujeto + participio pasado",example:"Have you finished? / Has she ever been to Paris?",exampleEs:"Â¿Has terminado? / Â¿Ella ha estado alguna vez en ParÃ­s?",tip:'Usa "ever" para preguntar sobre experiencias: "Have you ever tried sushi?"'},"past continuous":{name:"Questions: Past Continuous - Preguntas: Pasado continuo",description:"Se invierte was/were con el sujeto.",structure:"Was/Were + sujeto + verbo-ing",example:"Were you sleeping? / Was she working at 8?",exampleEs:"Â¿Estabas durmiendo? / Â¿Ella estaba trabajando a las 8?",tip:'Usa "was" para I/he/she/it y "were" para you/we/they.'},"will future":{name:'Questions: Will (Future) - Preguntas: Futuro con "will"',description:'Se invierte "will" con el sujeto.',structure:"Will + sujeto + verbo base",example:"Will you come? / Will they help us?",exampleEs:"Â¿VendrÃ¡s? / Â¿Nos ayudarÃ¡n?",tip:`"Will" es igual para todas las personas. En forma corta negativa: "Won't you come?"`},"first conditional":{name:"Questions: First Conditional - Preguntas: Primer condicional",description:'La pregunta se forma en la clÃ¡usula con "will", no en la de "if".',structure:"Will + sujeto + verbo base + if + present simple",example:"Will you go if it stops raining? / What will happen if we are late?",exampleEs:"Â¿IrÃ¡s si deja de llover? / Â¿QuÃ© pasarÃ¡ si llegamos tarde?",tip:'TambiÃ©n se puede preguntar con "if" al inicio: "If it rains, will you stay home?"'},modals:{name:"Questions: Modals - Preguntas: Verbos modales",description:"Se invierte el modal (can, should, must, etc.) con el sujeto.",structure:"Modal + sujeto + verbo base",example:"Can you swim? / Should we leave? / Must I finish today?",exampleEs:"Â¿Sabes nadar? / Â¿DeberÃ­amos irnos? / Â¿Debo terminar hoy?",tip:"Los modales funcionan como auxiliares â€” solo muÃ©velos al inicio de la oraciÃ³n."},"past perfect":{name:"Questions: Past Perfect - Preguntas: Pasado perfecto",description:'Se invierte "had" con el sujeto.',structure:"Had + sujeto + participio pasado",example:"Had you eaten before? / Had she already left?",exampleEs:"Â¿HabÃ­as comido antes? / Â¿Ella ya se habÃ­a ido?",tip:'"Had" es igual para todas las personas. Suele aparecer con "already", "ever", "before".'},"passive voice":{name:"Questions: Passive Voice - Preguntas: Voz pasiva",description:"Se invierte el auxiliar de la pasiva (is/was/have been/will be) con el sujeto.",structure:"Auxiliar + sujeto + participio pasado",example:"Was the letter sent? / Has the project been finished?",exampleEs:"Â¿Fue enviada la carta? / Â¿Ha sido terminado el proyecto?",tip:"Identifica el auxiliar de la voz pasiva y muÃ©velo al inicio."},"reported speech":{name:"Questions: Reported Speech - Preguntas: Discurso indirecto",description:"Las preguntas reportadas pierden la inversiÃ³n y usan orden de afirmaciÃ³n.",structure:"Sujeto + asked/wanted to know + if/wh- + orden normal",example:"She asked if I was coming. / He wanted to know where I lived.",exampleEs:"Ella preguntÃ³ si yo iba. / Ã‰l querÃ­a saber dÃ³nde vivÃ­a yo.",tip:'Las yes/no questions usan "if/whether". Las wh-questions mantienen la palabra interrogativa pero sin inversiÃ³n.'},subjunctive:{name:"Questions: Subjunctive - Preguntas: Subjuntivo",description:"Preguntas con deseos o sugerencias hipotÃ©ticas.",structure:"Do you wish + past simple / Should + sujeto + verbo base",example:"Do you wish you were taller? / Should he study harder?",exampleEs:"Â¿DesearÃ­as ser mÃ¡s alto? / Â¿DeberÃ­a Ã©l estudiar mÃ¡s?",tip:'Con "wish" se pregunta sobre deseos. Con "should" se pide consejo o sugerencia.'},"third conditional":{name:"Questions: Third Conditional - Preguntas: Tercer condicional",description:'Se invierte "would" con el sujeto en la clÃ¡usula principal.',structure:"Would + sujeto + have + participio + if + past perfect",example:"Would you have gone if she had invited you?",exampleEs:"Â¿HabrÃ­as ido si ella te hubiera invitado?",tip:'Pregunta sobre situaciones hipotÃ©ticas del pasado. La clÃ¡usula con "if" no cambia.'}};function an(s){const e=s.toLowerCase().trim();if(U[e])return U[e];for(const t of Object.keys(U))if(e.includes(t)||t.includes(e))return U[t];return e.includes("passive")?U["passive voice"]:e.includes("modal")?U.modals:ga}mt.push({level:"Preguntas",tenses:[ga,U["present simple"],U["present continuous"],U["going to"],U["simple past"],U["present perfect"],U["past continuous"],U["will future"],U["first conditional"],U.modals,U["past perfect"],U["third conditional"],U["passive voice"],U["reported speech"],U.subjunctive]});mt.push(sn);function rn(s){const e=s.toLowerCase().trim();for(const i of mt)for(const o of i.tenses)if(o.name.split(" - ")[0].toLowerCase().trim()===e)return o;let t=e.replace(/[-â€“,]/g," ");t.includes("passive")&&!t.includes("voice")&&(t=t.replace("passive","passive voice")),t.includes("future")&&!t.includes("will")&&(t+=" will");const a=new Set(t.split(/\s+/).filter(Boolean));let r=null,n=0;for(const i of mt)for(const o of i.tenses){const h=o.name.split(" - ")[0].toLowerCase().replace(/\([^)]*\)/g,"").replace(/[-â€“,:]/g," ").split(/\s+/).filter(Boolean);h.every(f=>a.has(f))&&h.length>n&&(r=o,n=h.length)}return r}var nn=j('<p class="spanish-sentence svelte-n845i0"> </p>'),on=or('<svg class="info-icon svelte-n845i0" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>'),ln=j('<span class="tag negative svelte-n845i0">negativo</span>'),cn=j('<button class="tag question clickable svelte-n845i0">pregunta <svg class="info-icon svelte-n845i0" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg></button>'),un=j('<div class="tense-popup svelte-n845i0"><p class="popup-title svelte-n845i0"> </p> <p class="popup-desc svelte-n845i0"> </p> <div class="popup-detail svelte-n845i0"><span class="popup-label svelte-n845i0">Estructura</span> <p class="popup-text svelte-n845i0"> </p></div> <div class="popup-detail example svelte-n845i0"><span class="popup-label svelte-n845i0">Ejemplo</span> <p class="popup-text svelte-n845i0"> </p> <p class="popup-text-es svelte-n845i0"> </p></div> <div class="popup-detail tip svelte-n845i0"><span class="popup-label svelte-n845i0">Tip</span> <p class="popup-text svelte-n845i0"> </p></div></div>'),dn=j('<div class="tense-popup question-popup svelte-n845i0"><p class="popup-title svelte-n845i0"> </p> <p class="popup-desc svelte-n845i0"> </p> <div class="popup-detail svelte-n845i0"><span class="popup-label svelte-n845i0">Estructura</span> <p class="popup-text svelte-n845i0"> </p></div> <div class="popup-detail example svelte-n845i0"><span class="popup-label svelte-n845i0">Ejemplo</span> <p class="popup-text svelte-n845i0"> </p> <p class="popup-text-es svelte-n845i0"> </p></div> <div class="popup-detail tip svelte-n845i0"><span class="popup-label svelte-n845i0">Tip</span> <p class="popup-text svelte-n845i0"> </p></div></div>'),pn=j('<div class="prompt-display svelte-n845i0"><div class="hints"><p class="hint-label svelte-n845i0">Pistas</p> <p class="hint-text svelte-n845i0"> </p> <!></div> <div class="meta svelte-n845i0"><button> <!></button> <!> <!></div> <!> <!></div>');function hn(s,e){Re(e,!0);let t=W(!1),a=W(!1);const r=le(()=>rn(e.metadata.tense)),n=le(()=>an(e.metadata.tense));function i(){c(r)&&T(t,!c(t)),T(a,!1)}function o(){T(a,!c(a)),T(t,!1)}var l=pn(),h=m(l),f=b(m(h),2),_=m(f,!0);d(f);var x=b(f,2);{var v=A=>{var O=nn(),G=m(O,!0);d(O),B(()=>P(G,e.spanishSentence)),M(A,O)};J(x,A=>{e.spanishSentence&&A(v)})}d(h);var k=b(h,2),S=m(k);let p;S.__click=i;var g=m(S),y=b(g);{var I=A=>{var O=on();M(A,O)};J(y,A=>{c(r)&&A(I)})}d(S);var C=b(S,2);{var E=A=>{var O=ln();M(A,O)};J(C,A=>{e.metadata.isNegative&&A(E)})}var D=b(C,2);{var N=A=>{var O=cn();O.__click=o,M(A,O)};J(D,A=>{e.metadata.isQuestion&&A(N)})}d(k);var z=b(k,2);{var F=A=>{var O=un(),G=m(O),H=m(G,!0);d(G);var Z=b(G,2),ee=m(Z,!0);d(Z);var $=b(Z,2),Q=b(m($),2),me=m(Q,!0);d(Q),d($);var re=b($,2),ge=b(m(re),2),Le=m(ge,!0);d(ge);var Ie=b(ge,2),Ue=m(Ie,!0);d(Ie),d(re);var we=b(re,2),_e=b(m(we),2),oe=m(_e,!0);d(_e),d(we),d(O),B(()=>{P(H,c(r).name),P(ee,c(r).description),P(me,c(r).structure),P(Le,c(r).example),P(Ue,c(r).exampleEs),P(oe,c(r).tip)}),M(A,O)};J(z,A=>{c(t)&&c(r)&&A(F)})}var q=b(z,2);{var Y=A=>{var O=dn(),G=m(O),H=m(G,!0);d(G);var Z=b(G,2),ee=m(Z,!0);d(Z);var $=b(Z,2),Q=b(m($),2),me=m(Q,!0);d(Q),d($);var re=b($,2),ge=b(m(re),2),Le=m(ge,!0);d(ge);var Ie=b(ge,2),Ue=m(Ie,!0);d(Ie),d(re);var we=b(re,2),_e=b(m(we),2),oe=m(_e,!0);d(_e),d(we),d(O),B(()=>{P(H,c(n).name),P(ee,c(n).description),P(me,c(n).structure),P(Le,c(n).example),P(Ue,c(n).exampleEs),P(oe,c(n).tip)}),M(A,O)};J(q,A=>{c(a)&&A(Y)})}d(l),B(()=>{P(_,e.hintDisplay),p=ft(S,1,"tag tense-tag svelte-n845i0",null,p,{clickable:!!c(r)}),P(g,`${e.metadata.tense??""} `)}),M(s,l),Me()}je(["click"]);var fn=j("<button> </button>");function va(s,e){let t=Or(e,"variant",3,"pool");var a=fn();a.__click=function(...n){e.onclick?.apply(this,n)};var r=m(a,!0);d(a),B(()=>{ft(a,1,`word-card ${t()??""}`,"svelte-pj5bsu"),P(r,e.text)}),M(s,a)}je(["click"]);var mn=j('<p class="placeholder svelte-1d0eofs">Toca las palabras para armar la frase...</p>'),gn=j('<div class="sentence-area svelte-1d0eofs"><p class="label svelte-1d0eofs">Tu frase</p> <div class="sentence-box svelte-1d0eofs"><!> <!></div></div>');function vn(s,e){Re(e,!0);var t=gn(),a=b(m(t),2),r=m(a);de(r,17,()=>e.cards,o=>o.id,(o,l)=>{va(o,{get text(){return c(l).text},onclick:()=>e.ondeselect(c(l).id),variant:"sentence"})});var n=b(r,2);{var i=o=>{var l=mn();M(o,l)};J(n,o=>{e.cards.length===0&&o(i)})}d(a),d(t),M(s,t),Me()}var bn=j('<p class="empty svelte-ymehbo">Todas las palabras fueron usadas</p>'),yn=j('<div class="card-pool svelte-ymehbo"><p class="label svelte-ymehbo">Palabras disponibles</p> <div class="cards svelte-ymehbo"><!> <!></div></div>');function wn(s,e){Re(e,!0);var t=yn(),a=b(m(t),2),r=m(a);de(r,17,()=>e.cards,o=>o.id,(o,l)=>{va(o,{get text(){return c(l).text},onclick:()=>e.onselect(c(l).id),variant:"pool"})});var n=b(r,2);{var i=o=>{var l=bn();M(o,l)};J(n,o=>{e.cards.length===0&&o(i)})}d(a),d(t),M(s,t),Me()}var _n=j('<div class="correct-answer svelte-p7nz7"><p class="correct-label svelte-p7nz7">Respuesta correcta:</p> <p class="correct-text svelte-p7nz7"> </p></div>'),xn=j('<div><div class="result-icon svelte-p7nz7"> </div> <p class="result-label svelte-p7nz7"> </p> <p class="feedback svelte-p7nz7"> </p> <!> <div class="grammar-note svelte-p7nz7"><p class="note-label svelte-p7nz7">Nota gramatical</p> <p class="note-text svelte-p7nz7"> </p></div> <button class="next-btn svelte-p7nz7">Siguiente</button></div>');function kn(s,e){Re(e,!0);var t=xn(),a=m(t),r=m(a,!0);d(a);var n=b(a,2),i=m(n,!0);d(n);var o=b(n,2),l=m(o,!0);d(o);var h=b(o,2);{var f=S=>{var p=_n(),g=b(m(p),2),y=m(g,!0);d(g),d(p),B(()=>P(y,e.result.correctSentence)),M(S,p)};J(h,S=>{e.result.isCorrect||S(f)})}var _=b(h,2),x=b(m(_),2),v=m(x,!0);d(x),d(_);var k=b(_,2);k.__click=function(...S){e.onnext?.apply(this,S)},d(t),B(()=>{ft(t,1,`feedback-panel ${e.result.isCorrect?"correct":"incorrect"}`,"svelte-p7nz7"),P(r,e.result.isCorrect?"âœ“":"âœ—"),P(i,e.result.isCorrect?"Â¡Correcto!":"Incorrecto"),P(l,e.result.feedback),P(v,e.result.grammarNote)}),M(s,t),Me()}je(["click"]);var Sn=j('<div class="score-bar svelte-1szkqx"><button class="back-btn svelte-1szkqx" aria-label="Volver al inicio"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></button> <div class="stat svelte-1szkqx"><span class="stat-value svelte-1szkqx"> </span> <span class="stat-label svelte-1szkqx">Ronda</span></div> <div class="stat svelte-1szkqx"><span class="stat-value svelte-1szkqx"> </span> <span class="stat-label svelte-1szkqx">Aciertos</span></div> <div class="stat svelte-1szkqx"><span class="stat-value svelte-1szkqx"> </span> <span class="stat-label svelte-1szkqx">Racha</span></div> <div class="stat svelte-1szkqx"><span class="stat-value svelte-1szkqx"> </span> <span class="stat-label svelte-1szkqx">Mejor</span></div></div>');function Tn(s,e){Re(e,!0);var t=Sn(),a=m(t);a.__click=function(...p){e.onback?.apply(this,p)};var r=b(a,2),n=m(r),i=m(n,!0);d(n),Pe(2),d(r);var o=b(r,2),l=m(o),h=m(l);d(l),Pe(2),d(o);var f=b(o,2),_=m(f),x=m(_,!0);d(_),Pe(2),d(f);var v=b(f,2),k=m(v),S=m(k,!0);d(k),Pe(2),d(v),d(t),B(()=>{P(i,e.session.currentRound),P(h,`${e.session.totalCorrect??""}/${e.session.totalAttempted??""}`),P(x,e.session.streak),P(S,e.session.bestStreak)}),M(s,t),Me()}je(["click"]);let Rs=W(""),ba=W("beginner"),ya=W("random"),wa=W(void 0),_a=W(!1),Ms=W("setup"),De=W(null),he=W(Ps([])),vt=W(null),bt=W(null),Ht=W(Ps([])),ce=W(Ps({currentRound:0,totalCorrect:0,totalAttempted:0,streak:0,bestStreak:0}));function Us(){return c(Rs)}function En(){return c(ba)}function Pn(){return c(ya)}function Rn(){return c(wa)}function Mn(){return c(_a)}function xa(){return c(Ms)}function jn(){return c(De)}function An(){return c(vt)}function In(){return c(bt)}function Cn(){return c(Ht)}function Nn(){return c(ce)}function qn(s){T(Rs,s,!0),localStorage.setItem("grammar_game_api_key",s)}function On(){const s=localStorage.getItem("grammar_game_api_key");return s&&T(Rs,s,!0),!!s}function Dn(s){T(ba,s,!0)}function Ln(s){T(ya,s,!0)}function zn(s){T(wa,s,!0)}function Bn(s){T(_a,s,!0)}function be(s){T(Ms,s,!0)}function ka(s){T(De,s,!0),T(he,[],!0),T(vt,null),T(bt,null),T(Ht,[...c(Ht).slice(-9),s.correctSentence],!0)}function Wn(s){T(vt,s,!0),c(ce).totalAttempted++,s.isCorrect?(c(ce).totalCorrect++,c(ce).streak++,c(ce).streak>c(ce).bestStreak&&(c(ce).bestStreak=c(ce).streak)):c(ce).streak=0}function Ut(s){T(bt,s,!0)}function Un(s){c(he).includes(s)||T(he,[...c(he),s],!0)}function Vn(s){T(he,c(he).filter(e=>e!==s),!0)}function Fn(){T(he,[],!0)}function Hn(){return c(De)?c(De).cards.filter(s=>!c(he).includes(s.id)):[]}function Sa(){return c(De)?c(he).map(s=>c(De).cards.find(e=>e.id===s)).filter(s=>s!==void 0):[]}function $n(){return Sa().map(s=>s.text).join(" ")}function Ta(){c(ce).currentRound++,T(De,null),T(he,[],!0),T(vt,null),T(bt,null)}function Jn(){T(Ms,"setup"),T(De,null),T(he,[],!0),T(vt,null),T(bt,null),T(Ht,[],!0),T(ce,{currentRound:0,totalCorrect:0,totalAttempted:0,streak:0,bestStreak:0},!0)}function w(s,e,t,a,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t}function u(s,e,t,a){if(t==="a"&&!a)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?a:t==="a"?a.call(s):a?a.value:e.get(s)}let Ea=function(){const{crypto:s}=globalThis;if(s?.randomUUID)return Ea=s.randomUUID.bind(s),s.randomUUID();const e=new Uint8Array(1),t=s?()=>s.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(+a^t()&15>>+a/4).toString(16))};function gt(s){return typeof s=="object"&&s!==null&&("name"in s&&s.name==="AbortError"||"message"in s&&String(s.message).includes("FetchRequestCanceledException"))}const ws=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null){try{if(Object.prototype.toString.call(s)==="[object Error]"){const e=new Error(s.message,s.cause?{cause:s.cause}:{});return s.stack&&(e.stack=s.stack),s.cause&&!e.cause&&(e.cause=s.cause),s.name&&(e.name=s.name),e}}catch{}try{return new Error(JSON.stringify(s))}catch{}}return new Error(s)};class R extends Error{}class X extends R{constructor(e,t,a,r){super(`${X.makeMessage(e,t,a)}`),this.status=e,this.headers=r,this.requestID=r?.get("request-id"),this.error=t}static makeMessage(e,t,a){const r=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):a;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,a,r){if(!e||!r)return new Xt({message:a,cause:ws(t)});const n=t;return e===400?new Ra(e,n,a,r):e===401?new Ma(e,n,a,r):e===403?new ja(e,n,a,r):e===404?new Aa(e,n,a,r):e===409?new Ia(e,n,a,r):e===422?new Ca(e,n,a,r):e===429?new Na(e,n,a,r):e>=500?new qa(e,n,a,r):new X(e,n,a,r)}}class pe extends X{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Xt extends X{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Pa extends Xt{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Ra extends X{}class Ma extends X{}class ja extends X{}class Aa extends X{}class Ia extends X{}class Ca extends X{}class Na extends X{}class qa extends X{}const Qn=/^[a-z][a-z0-9+.-]*:/i,Xn=s=>Qn.test(s);let _s=s=>(_s=Array.isArray,_s(s)),Vs=_s;function Fs(s){return typeof s!="object"?{}:s??{}}function Gn(s){if(!s)return!0;for(const e in s)return!1;return!0}function Kn(s,e){return Object.prototype.hasOwnProperty.call(s,e)}const Yn=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new R(`${s} must be an integer`);if(e<0)throw new R(`${s} must be a positive integer`);return e},Oa=s=>{try{return JSON.parse(s)}catch{return}},Zn=s=>new Promise(e=>setTimeout(e,s)),Je="0.65.0",ei=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function ti(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const si=()=>{const s=ti();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Je,"X-Stainless-OS":$s(Deno.build.os),"X-Stainless-Arch":Hs(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Je,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Je,"X-Stainless-OS":$s(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Hs(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=ai();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Je,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Je,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ai(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const a=t.exec(navigator.userAgent);if(a){const r=a[1]||0,n=a[2]||0,i=a[3]||0;return{browser:e,version:`${r}.${n}.${i}`}}}return null}const Hs=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",$s=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let Js;const ri=()=>Js??(Js=si());function ni(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Da(...s){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...s)}function La(s){let e=Symbol.asyncIterator in s?s[Symbol.asyncIterator]():s[Symbol.iterator]();return Da({start(){},async pull(t){const{done:a,value:r}=await e.next();a?t.close():t.enqueue(r)},async cancel(){await e.return?.()}})}function js(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function ii(s){if(s===null||typeof s!="object")return;if(s[Symbol.asyncIterator]){await s[Symbol.asyncIterator]().return?.();return}const e=s.getReader(),t=e.cancel();e.releaseLock(),await t}const oi=({headers:s,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});function li(s){let e=0;for(const r of s)e+=r.length;const t=new Uint8Array(e);let a=0;for(const r of s)t.set(r,a),a+=r.length;return t}let Qs;function As(s){let e;return(Qs??(e=new globalThis.TextEncoder,Qs=e.encode.bind(e)))(s)}let Xs;function Gs(s){let e;return(Xs??(e=new globalThis.TextDecoder,Xs=e.decode.bind(e)))(s)}var se,ae;class yt{constructor(){se.set(this,void 0),ae.set(this,void 0),w(this,se,new Uint8Array),w(this,ae,null)}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?As(e):e;w(this,se,li([u(this,se,"f"),t]));const a=[];let r;for(;(r=ci(u(this,se,"f"),u(this,ae,"f")))!=null;){if(r.carriage&&u(this,ae,"f")==null){w(this,ae,r.index);continue}if(u(this,ae,"f")!=null&&(r.index!==u(this,ae,"f")+1||r.carriage)){a.push(Gs(u(this,se,"f").subarray(0,u(this,ae,"f")-1))),w(this,se,u(this,se,"f").subarray(u(this,ae,"f"))),w(this,ae,null);continue}const n=u(this,ae,"f")!==null?r.preceding-1:r.preceding,i=Gs(u(this,se,"f").subarray(0,n));a.push(i),w(this,se,u(this,se,"f").subarray(r.index)),w(this,ae,null)}return a}flush(){return u(this,se,"f").length?this.decode(`
`):[]}}se=new WeakMap,ae=new WeakMap;yt.NEWLINE_CHARS=new Set([`
`,"\r"]);yt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ci(s,e){for(let r=e??0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function ui(s){for(let a=0;a<s.length-1;a++){if(s[a]===10&&s[a+1]===10||s[a]===13&&s[a+1]===13)return a+2;if(s[a]===13&&s[a+1]===10&&a+3<s.length&&s[a+2]===13&&s[a+3]===10)return a+4}return-1}const $t={off:0,error:200,warn:300,info:400,debug:500},Ks=(s,e,t)=>{if(s){if(Kn($t,s))return s;K(t).warn(`${e} was set to ${JSON.stringify(s)}, expected one of ${JSON.stringify(Object.keys($t))}`)}};function pt(){}function Tt(s,e,t){return!e||$t[s]>$t[t]?pt:e[s].bind(e)}const di={error:pt,warn:pt,info:pt,debug:pt};let Ys=new WeakMap;function K(s){const e=s.logger,t=s.logLevel??"off";if(!e)return di;const a=Ys.get(e);if(a&&a[0]===t)return a[1];const r={error:Tt("error",e,t),warn:Tt("warn",e,t),info:Tt("info",e,t),debug:Tt("debug",e,t)};return Ys.set(e,[t,r]),r}const We=s=>(s.options&&(s.options={...s.options},delete s.options.headers),s.headers&&(s.headers=Object.fromEntries((s.headers instanceof Headers?[...s.headers]:Object.entries(s.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in s&&(s.retryOfRequestLogID&&(s.retryOf=s.retryOfRequestLogID),delete s.retryOfRequestLogID),s);var Ke;class ye{constructor(e,t,a){this.iterator=e,Ke.set(this,void 0),this.controller=t,w(this,Ke,a)}static fromSSEResponse(e,t,a){let r=!1;const n=a?K(a):console;async function*i(){if(r)throw new R("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of pi(e,t)){if(l.event==="completion")try{yield JSON.parse(l.data)}catch(h){throw n.error("Could not parse message into JSON:",l.data),n.error("From chunk:",l.raw),h}if(l.event==="message_start"||l.event==="message_delta"||l.event==="message_stop"||l.event==="content_block_start"||l.event==="content_block_delta"||l.event==="content_block_stop")try{yield JSON.parse(l.data)}catch(h){throw n.error("Could not parse message into JSON:",l.data),n.error("From chunk:",l.raw),h}if(l.event!=="ping"&&l.event==="error")throw new X(void 0,Oa(l.data)??l.data,void 0,e.headers)}o=!0}catch(l){if(gt(l))return;throw l}finally{o||t.abort()}}return new ye(i,t,a)}static fromReadableStream(e,t,a){let r=!1;async function*n(){const o=new yt,l=js(e);for await(const h of l)for(const f of o.decode(h))yield f;for(const h of o.flush())yield h}async function*i(){if(r)throw new R("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of n())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(gt(l))return;throw l}finally{o||t.abort()}}return new ye(i,t,a)}[(Ke=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],t=[],a=this.iterator(),r=n=>({next:()=>{if(n.length===0){const i=a.next();e.push(i),t.push(i)}return n.shift()}});return[new ye(()=>r(e),this.controller,u(this,Ke,"f")),new ye(()=>r(t),this.controller,u(this,Ke,"f"))]}toReadableStream(){const e=this;let t;return Da({async start(){t=e[Symbol.asyncIterator]()},async pull(a){try{const{value:r,done:n}=await t.next();if(n)return a.close();const i=As(JSON.stringify(r)+`
`);a.enqueue(i)}catch(r){a.error(r)}},async cancel(){await t.return?.()}})}}async function*pi(s,e){if(!s.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new R("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new R("Attempted to iterate over a response with no body");const t=new fi,a=new yt,r=js(s.body);for await(const n of hi(r))for(const i of a.decode(n)){const o=t.decode(i);o&&(yield o)}for(const n of a.flush()){const i=t.decode(n);i&&(yield i)}}async function*hi(s){let e=new Uint8Array;for await(const t of s){if(t==null)continue;const a=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?As(t):t;let r=new Uint8Array(e.length+a.length);r.set(e),r.set(a,e.length),e=r;let n;for(;(n=ui(e))!==-1;)yield e.slice(0,n),e=e.slice(n)}e.length>0&&(yield e)}class fi{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const n={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],n}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,a,r]=mi(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function mi(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}async function za(s,e){const{response:t,requestLogID:a,retryOfRequestLogID:r,startTime:n}=e,i=await(async()=>{if(e.options.stream)return K(s).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):ye.fromSSEResponse(t,e.controller);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const l=t.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){const _=await t.json();return Ba(_,t)}return await t.text()})();return K(s).debug(`[${a}] response parsed`,We({retryOfRequestLogID:r,url:t.url,status:t.status,body:i,durationMs:Date.now()-n})),i}function Ba(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}var ht;class Gt extends Promise{constructor(e,t,a=za){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=a,ht.set(this,void 0),w(this,ht,e)}_thenUnwrap(e){return new Gt(u(this,ht,"f"),this.responsePromise,async(t,a)=>Ba(e(await this.parseResponse(t,a),a),a.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(u(this,ht,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}ht=new WeakMap;var Et;class gi{constructor(e,t,a,r){Et.set(this,void 0),w(this,Et,e),this.options=r,this.response=t,this.body=a}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new R("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await u(this,Et,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Et=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class vi extends Gt{constructor(e,t,a){super(e,t,async(r,n)=>new a(r,n.response,await za(r,n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}class wt extends gi{constructor(e,t,a,r){super(e,t,a,r),this.data=a.data||[],this.has_more=a.has_more||!1,this.first_id=a.first_id||null,this.last_id=a.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){const t=this.first_id;return t?{...this.options,query:{...Fs(this.options.query),before_id:t}}:null}const e=this.last_id;return e?{...this.options,query:{...Fs(this.options.query),after_id:e}}:null}}const Wa=()=>{if(typeof File>"u"){const{process:s}=globalThis,e=typeof s?.versions?.node=="string"&&parseInt(s.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Xe(s,e,t){return Wa(),new File(s,e??"unknown_file",t)}function Vt(s){return(typeof s=="object"&&s!==null&&("name"in s&&s.name&&String(s.name)||"url"in s&&s.url&&String(s.url)||"filename"in s&&s.filename&&String(s.filename)||"path"in s&&s.path&&String(s.path))||"").split(/[\\/]/).pop()||void 0}const Ua=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",bi=async(s,e)=>({...s,body:await wi(s.body,e)}),Zs=new WeakMap;function yi(s){const e=typeof s=="function"?s:s.fetch,t=Zs.get(e);if(t)return t;const a=(async()=>{try{const r="Response"in e?e.Response:(await e("data:,")).constructor,n=new FormData;return n.toString()!==await new r(n).text()}catch{return!0}})();return Zs.set(e,a),a}const wi=async(s,e)=>{if(!await yi(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const t=new FormData;return await Promise.all(Object.entries(s||{}).map(([a,r])=>xs(t,a,r))),t},_i=s=>s instanceof Blob&&"name"in s,xs=async(s,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(t instanceof Response){let a={};const r=t.headers.get("Content-Type");r&&(a={type:r}),s.append(e,Xe([await t.blob()],Vt(t),a))}else if(Ua(t))s.append(e,Xe([await new Response(La(t)).blob()],Vt(t)));else if(_i(t))s.append(e,Xe([t],Vt(t),{type:t.type}));else if(Array.isArray(t))await Promise.all(t.map(a=>xs(s,e+"[]",a)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([a,r])=>xs(s,`${e}[${a}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}},Va=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",xi=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Va(s),ki=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function";async function Si(s,e,t){if(Wa(),s=await s,e||(e=Vt(s)),xi(s))return s instanceof File&&e==null&&t==null?s:Xe([await s.arrayBuffer()],e??s.name,{type:s.type,lastModified:s.lastModified,...t});if(ki(s)){const r=await s.blob();return e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()),Xe(await ks(r),e,t)}const a=await ks(s);if(!t?.type){const r=a.find(n=>typeof n=="object"&&"type"in n&&n.type);typeof r=="string"&&(t={...t,type:r})}return Xe(a,e,t)}async function ks(s){let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(Va(s))e.push(s instanceof Blob?s:await s.arrayBuffer());else if(Ua(s))for await(const t of s)e.push(...await ks(t));else{const t=s?.constructor?.name;throw new Error(`Unexpected data type: ${typeof s}${t?`; constructor: ${t}`:""}${Ti(s)}`)}return e}function Ti(s){return typeof s!="object"||s===null?"":`; props: [${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}class Ae{constructor(e){this._client=e}}const Fa=Symbol.for("brand.privateNullableHeaders");function*Ei(s){if(!s)return;if(Fa in s){const{values:a,nulls:r}=s;yield*a.entries();for(const n of r)yield[n,null];return}let e=!1,t;s instanceof Headers?t=s.entries():Vs(s)?t=s:(e=!0,t=Object.entries(s??{}));for(let a of t){const r=a[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const n=Vs(a[1])?a[1]:[a[1]];let i=!1;for(const o of n)o!==void 0&&(e&&!i&&(i=!0,yield[r,null]),yield[r,o])}}const L=s=>{const e=new Headers,t=new Set;for(const a of s){const r=new Set;for(const[n,i]of Ei(a)){const o=n.toLowerCase();r.has(o)||(e.delete(n),r.add(o)),i===null?(e.delete(n),t.add(o)):(e.append(n,i),t.delete(o))}}return{[Fa]:!0,values:e,nulls:t}};function Ha(s){return s.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const ea=Object.freeze(Object.create(null)),Pi=(s=Ha)=>function(t,...a){if(t.length===1)return t[0];let r=!1;const n=[],i=t.reduce((f,_,x)=>{/[?#]/.test(_)&&(r=!0);const v=a[x];let k=(r?encodeURIComponent:s)(""+v);return x!==a.length&&(v==null||typeof v=="object"&&v.toString===Object.getPrototypeOf(Object.getPrototypeOf(v.hasOwnProperty??ea)??ea)?.toString)&&(k=v+"",n.push({start:f.length+_.length,length:k.length,error:`Value of type ${Object.prototype.toString.call(v).slice(8,-1)} is not a valid path parameter`})),f+_+(x===a.length?"":k)},""),o=i.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=l.exec(o))!==null;)n.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(n.sort((f,_)=>f.start-_.start),n.length>0){let f=0;const _=n.reduce((x,v)=>{const k=" ".repeat(v.start-f),S="^".repeat(v.length);return f=v.start+v.length,x+k+S},"");throw new R(`Path parameters result in path with invalid segments:
${n.map(x=>x.error).join(`
`)}
${i}
${_}`)}return i},fe=Pi(Ha);class $a extends Ae{list(e={},t){const{betas:a,...r}=e??{};return this._client.getAPIList("/v1/files",wt,{query:r,...t,headers:L([{"anthropic-beta":[...a??[],"files-api-2025-04-14"].toString()},t?.headers])})}delete(e,t={},a){const{betas:r}=t??{};return this._client.delete(fe`/v1/files/${e}`,{...a,headers:L([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},a?.headers])})}download(e,t={},a){const{betas:r}=t??{};return this._client.get(fe`/v1/files/${e}/content`,{...a,headers:L([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},a?.headers]),__binaryResponse:!0})}retrieveMetadata(e,t={},a){const{betas:r}=t??{};return this._client.get(fe`/v1/files/${e}`,{...a,headers:L([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},a?.headers])})}upload(e,t){const{betas:a,...r}=e;return this._client.post("/v1/files",bi({body:r,...t,headers:L([{"anthropic-beta":[...a??[],"files-api-2025-04-14"].toString()},t?.headers])},this._client))}}let Ja=class extends Ae{retrieve(e,t={},a){const{betas:r}=t??{};return this._client.get(fe`/v1/models/${e}?beta=true`,{...a,headers:L([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},a?.headers])})}list(e={},t){const{betas:a,...r}=e??{};return this._client.getAPIList("/v1/models?beta=true",wt,{query:r,...t,headers:L([{...a?.toString()!=null?{"anthropic-beta":a?.toString()}:void 0},t?.headers])})}};class Kt{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new yt;for await(const t of this.iterator)for(const a of e.decode(t))yield JSON.parse(a);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new R("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new R("Attempted to iterate over a response with no body");return new Kt(js(e.body),t)}}let Qa=class extends Ae{create(e,t){const{betas:a,...r}=e;return this._client.post("/v1/messages/batches?beta=true",{body:r,...t,headers:L([{"anthropic-beta":[...a??[],"message-batches-2024-09-24"].toString()},t?.headers])})}retrieve(e,t={},a){const{betas:r}=t??{};return this._client.get(fe`/v1/messages/batches/${e}?beta=true`,{...a,headers:L([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},a?.headers])})}list(e={},t){const{betas:a,...r}=e??{};return this._client.getAPIList("/v1/messages/batches?beta=true",wt,{query:r,...t,headers:L([{"anthropic-beta":[...a??[],"message-batches-2024-09-24"].toString()},t?.headers])})}delete(e,t={},a){const{betas:r}=t??{};return this._client.delete(fe`/v1/messages/batches/${e}?beta=true`,{...a,headers:L([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},a?.headers])})}cancel(e,t={},a){const{betas:r}=t??{};return this._client.post(fe`/v1/messages/batches/${e}/cancel?beta=true`,{...a,headers:L([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},a?.headers])})}async results(e,t={},a){const r=await this.retrieve(e);if(!r.results_url)throw new R(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);const{betas:n}=t??{};return this._client.get(r.results_url,{...a,headers:L([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},a?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((i,o)=>Kt.fromResponse(o.response,o.controller))}};const Ri=s=>{let e=0,t=[];for(;e<s.length;){let a=s[e];if(a==="\\"){e++;continue}if(a==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(a==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(a==="["){t.push({type:"paren",value:"["}),e++;continue}if(a==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(a===":"){t.push({type:"separator",value:":"}),e++;continue}if(a===","){t.push({type:"delimiter",value:","}),e++;continue}if(a==='"'){let o="",l=!1;for(a=s[++e];a!=='"';){if(e===s.length){l=!0;break}if(a==="\\"){if(e++,e===s.length){l=!0;break}o+=a+s[e],a=s[++e]}else o+=a,a=s[++e]}a=s[++e],l||t.push({type:"string",value:o});continue}if(a&&/\s/.test(a)){e++;continue}let n=/[0-9]/;if(a&&n.test(a)||a==="-"||a==="."){let o="";for(a==="-"&&(o+=a,a=s[++e]);a&&n.test(a)||a===".";)o+=a,a=s[++e];t.push({type:"number",value:o});continue}let i=/[a-z]/i;if(a&&i.test(a)){let o="";for(;a&&i.test(a)&&e!==s.length;)o+=a,a=s[++e];if(o=="true"||o=="false"||o==="null")t.push({type:"name",value:o});else{e++;continue}continue}e++}return t},Qe=s=>{if(s.length===0)return s;let e=s[s.length-1];switch(e.type){case"separator":return s=s.slice(0,s.length-1),Qe(s);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return s=s.slice(0,s.length-1),Qe(s);case"string":let a=s[s.length-2];if(a?.type==="delimiter")return s=s.slice(0,s.length-1),Qe(s);if(a?.type==="brace"&&a.value==="{")return s=s.slice(0,s.length-1),Qe(s);break;case"delimiter":return s=s.slice(0,s.length-1),Qe(s)}return s},Mi=s=>{let e=[];return s.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?s.push({type:"brace",value:"}"}):t==="]"&&s.push({type:"paren",value:"]"})}),s},ji=s=>{let e="";return s.map(t=>{t.type==="string"?e+='"'+t.value+'"':e+=t.value}),e},Xa=s=>JSON.parse(ji(Mi(Qe(Ri(s)))));var ne,Ne,Ye,Pt,Ze,et,Rt,tt,xe,st,Mt,jt,Ve,At,It,os,ta,Ct,ls,cs,us,sa;const aa="__json_buf";function ra(s){return s.type==="tool_use"||s.type==="server_tool_use"||s.type==="mcp_tool_use"}class Jt{constructor(){ne.add(this),this.messages=[],this.receivedMessages=[],Ne.set(this,void 0),this.controller=new AbortController,Ye.set(this,void 0),Pt.set(this,()=>{}),Ze.set(this,()=>{}),et.set(this,void 0),Rt.set(this,()=>{}),tt.set(this,()=>{}),xe.set(this,{}),st.set(this,!1),Mt.set(this,!1),jt.set(this,!1),Ve.set(this,!1),At.set(this,void 0),It.set(this,void 0),Ct.set(this,e=>{if(w(this,Mt,!0),gt(e)&&(e=new pe),e instanceof pe)return w(this,jt,!0),this._emit("abort",e);if(e instanceof R)return this._emit("error",e);if(e instanceof Error){const t=new R(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new R(String(e)))}),w(this,Ye,new Promise((e,t)=>{w(this,Pt,e,"f"),w(this,Ze,t,"f")})),w(this,et,new Promise((e,t)=>{w(this,Rt,e,"f"),w(this,tt,t,"f")})),u(this,Ye,"f").catch(()=>{}),u(this,et,"f").catch(()=>{})}get response(){return u(this,At,"f")}get request_id(){return u(this,It,"f")}async withResponse(){const e=await u(this,Ye,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const t=new Jt;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,a){const r=new Jt;for(const n of t.messages)r._addMessageParam(n);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},u(this,Ct,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,a){const r=a?.signal;let n;r&&(r.aborted&&this.controller.abort(),n=this.controller.abort.bind(this.controller),r.addEventListener("abort",n));try{u(this,ne,"m",ls).call(this);const{response:i,data:o}=await e.create({...t,stream:!0},{...a,signal:this.controller.signal}).withResponse();this._connected(i);for await(const l of o)u(this,ne,"m",cs).call(this,l);if(o.controller.signal?.aborted)throw new pe;u(this,ne,"m",us).call(this)}finally{r&&n&&r.removeEventListener("abort",n)}}_connected(e){this.ended||(w(this,At,e),w(this,It,e?.headers.get("request-id")),u(this,Pt,"f").call(this,e),this._emit("connect"))}get ended(){return u(this,st,"f")}get errored(){return u(this,Mt,"f")}get aborted(){return u(this,jt,"f")}abort(){this.controller.abort()}on(e,t){return(u(this,xe,"f")[e]||(u(this,xe,"f")[e]=[])).push({listener:t}),this}off(e,t){const a=u(this,xe,"f")[e];if(!a)return this;const r=a.findIndex(n=>n.listener===t);return r>=0&&a.splice(r,1),this}once(e,t){return(u(this,xe,"f")[e]||(u(this,xe,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,a)=>{w(this,Ve,!0),e!=="error"&&this.once("error",a),this.once(e,t)})}async done(){w(this,Ve,!0),await u(this,et,"f")}get currentMessage(){return u(this,Ne,"f")}async finalMessage(){return await this.done(),u(this,ne,"m",os).call(this)}async finalText(){return await this.done(),u(this,ne,"m",ta).call(this)}_emit(e,...t){if(u(this,st,"f"))return;e==="end"&&(w(this,st,!0),u(this,Rt,"f").call(this));const a=u(this,xe,"f")[e];if(a&&(u(this,xe,"f")[e]=a.filter(r=>!r.once),a.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!u(this,Ve,"f")&&!a?.length&&Promise.reject(r),u(this,Ze,"f").call(this,r),u(this,tt,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!u(this,Ve,"f")&&!a?.length&&Promise.reject(r),u(this,Ze,"f").call(this,r),u(this,tt,"f").call(this,r),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",u(this,ne,"m",os).call(this))}async _fromReadableStream(e,t){const a=t?.signal;let r;a&&(a.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),a.addEventListener("abort",r));try{u(this,ne,"m",ls).call(this),this._connected(null);const n=ye.fromReadableStream(e,this.controller);for await(const i of n)u(this,ne,"m",cs).call(this,i);if(n.controller.signal?.aborted)throw new pe;u(this,ne,"m",us).call(this)}finally{a&&r&&a.removeEventListener("abort",r)}}[(Ne=new WeakMap,Ye=new WeakMap,Pt=new WeakMap,Ze=new WeakMap,et=new WeakMap,Rt=new WeakMap,tt=new WeakMap,xe=new WeakMap,st=new WeakMap,Mt=new WeakMap,jt=new WeakMap,Ve=new WeakMap,At=new WeakMap,It=new WeakMap,Ct=new WeakMap,ne=new WeakSet,os=function(){if(this.receivedMessages.length===0)throw new R("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},ta=function(){if(this.receivedMessages.length===0)throw new R("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(a=>a.type==="text").map(a=>a.text);if(t.length===0)throw new R("stream ended without producing a content block with type=text");return t.join(" ")},ls=function(){this.ended||w(this,Ne,void 0)},cs=function(t){if(this.ended)return;const a=u(this,ne,"m",sa).call(this,t);switch(this._emit("streamEvent",t,a),t.type){case"content_block_delta":{const r=a.content.at(-1);switch(t.delta.type){case"text_delta":{r.type==="text"&&this._emit("text",t.delta.text,r.text||"");break}case"citations_delta":{r.type==="text"&&this._emit("citation",t.delta.citation,r.citations??[]);break}case"input_json_delta":{ra(r)&&r.input&&this._emit("inputJson",t.delta.partial_json,r.input);break}case"thinking_delta":{r.type==="thinking"&&this._emit("thinking",t.delta.thinking,r.thinking);break}case"signature_delta":{r.type==="thinking"&&this._emit("signature",r.signature);break}default:t.delta}break}case"message_stop":{this._addMessageParam(a),this._addMessage(a,!0);break}case"content_block_stop":{this._emit("contentBlock",a.content.at(-1));break}case"message_start":{w(this,Ne,a);break}}},us=function(){if(this.ended)throw new R("stream has ended, this shouldn't happen");const t=u(this,Ne,"f");if(!t)throw new R("request ended without sending any chunks");return w(this,Ne,void 0),t},sa=function(t){let a=u(this,Ne,"f");if(t.type==="message_start"){if(a)throw new R(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!a)throw new R(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return a;case"message_delta":return a.container=t.delta.container,a.stop_reason=t.delta.stop_reason,a.stop_sequence=t.delta.stop_sequence,a.usage.output_tokens=t.usage.output_tokens,a.context_management=t.context_management,t.usage.input_tokens!=null&&(a.usage.input_tokens=t.usage.input_tokens),t.usage.cache_creation_input_tokens!=null&&(a.usage.cache_creation_input_tokens=t.usage.cache_creation_input_tokens),t.usage.cache_read_input_tokens!=null&&(a.usage.cache_read_input_tokens=t.usage.cache_read_input_tokens),t.usage.server_tool_use!=null&&(a.usage.server_tool_use=t.usage.server_tool_use),a;case"content_block_start":return a.content.push(t.content_block),a;case"content_block_delta":{const r=a.content.at(t.index);switch(t.delta.type){case"text_delta":{r?.type==="text"&&(a.content[t.index]={...r,text:(r.text||"")+t.delta.text});break}case"citations_delta":{r?.type==="text"&&(a.content[t.index]={...r,citations:[...r.citations??[],t.delta.citation]});break}case"input_json_delta":{if(r&&ra(r)){let n=r[aa]||"";n+=t.delta.partial_json;const i={...r};if(Object.defineProperty(i,aa,{value:n,enumerable:!1,writable:!0}),n)try{i.input=Xa(n)}catch(o){const l=new R(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${o}. JSON: ${n}`);u(this,Ct,"f").call(this,l)}a.content[t.index]=i}break}case"thinking_delta":{r?.type==="thinking"&&(a.content[t.index]={...r,thinking:r.thinking+t.delta.thinking});break}case"signature_delta":{r?.type==="thinking"&&(a.content[t.index]={...r,signature:t.delta.signature});break}default:t.delta}return a}case"content_block_stop":return a}},Symbol.asyncIterator)](){const e=[],t=[];let a=!1;return this.on("streamEvent",r=>{const n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{a=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{a=!0;for(const n of t)n.reject(r);t.length=0}),this.on("error",r=>{a=!0;for(const n of t)n.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((n,i)=>t.push({resolve:n,reject:i})).then(n=>n?{value:n,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ye(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const Ga={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192,"claude-opus-4-1-20250805":8192,"anthropic.claude-opus-4-1-20250805-v1:0":8192,"claude-opus-4-1@20250805":8192};var Nt,Fe,ze,te,at,ve,Te,qe,rt,Ss;function na(){let s,e;return{promise:new Promise((a,r)=>{s=a,e=r}),resolve:s,reject:e}}class Ka{constructor(e,t,a){Nt.add(this),this.client=e,Fe.set(this,!1),ze.set(this,!1),te.set(this,void 0),at.set(this,void 0),ve.set(this,void 0),Te.set(this,void 0),qe.set(this,void 0),rt.set(this,0),w(this,te,{params:{...t,messages:structuredClone(t.messages)}}),w(this,at,{...a,headers:L([{"x-stainless-helper":"BetaToolRunner"},a?.headers])}),w(this,qe,na())}async*[(Fe=new WeakMap,ze=new WeakMap,te=new WeakMap,at=new WeakMap,ve=new WeakMap,Te=new WeakMap,qe=new WeakMap,rt=new WeakMap,Nt=new WeakSet,Symbol.asyncIterator)](){var e;if(u(this,Fe,"f"))throw new R("Cannot iterate over a consumed stream");w(this,Fe,!0),w(this,ze,!0),w(this,Te,void 0);try{for(;;){let t;try{if(u(this,te,"f").params.max_iterations&&u(this,rt,"f")>=u(this,te,"f").params.max_iterations)break;w(this,ze,!1,"f"),w(this,ve,void 0,"f"),w(this,Te,void 0,"f"),w(this,rt,(e=u(this,rt,"f"),e++,e),"f");const{max_iterations:a,...r}=u(this,te,"f").params;if(r.stream?(t=this.client.beta.messages.stream({...r},u(this,at,"f")),w(this,ve,t.finalMessage(),"f"),yield t):(w(this,ve,this.client.beta.messages.create({...r,stream:!1},u(this,at,"f")),"f"),yield u(this,ve,"f")),!u(this,ze,"f")){const{role:i,content:o}=await u(this,ve,"f");u(this,te,"f").params.messages.push({role:i,content:o})}const n=await u(this,Nt,"m",Ss).call(this,u(this,te,"f").params.messages.at(-1));if(n&&u(this,te,"f").params.messages.push(n),!n&&!u(this,ze,"f"))break}finally{t&&t.abort()}}if(!u(this,ve,"f"))throw new R("ToolRunner concluded without a message from the server");u(this,qe,"f").resolve(await u(this,ve,"f"))}catch(t){throw w(this,Fe,!1),u(this,qe,"f").promise.catch(()=>{}),u(this,qe,"f").reject(t),w(this,qe,na()),t}}setMessagesParams(e){typeof e=="function"?u(this,te,"f").params=e(u(this,te,"f").params):u(this,te,"f").params=e,w(this,ze,!0),w(this,Te,void 0)}async generateToolResponse(){const e=await u(this,ve,"f")??this.params.messages.at(-1);return e?u(this,Nt,"m",Ss).call(this,e):null}done(){return u(this,qe,"f").promise}async runUntilDone(){if(!u(this,Fe,"f"))for await(const e of this);return this.done()}get params(){return u(this,te,"f").params}pushMessages(...e){this.setMessagesParams(t=>({...t,messages:[...t.messages,...e]}))}then(e,t){return this.runUntilDone().then(e,t)}}Ss=async function(e){return u(this,Te,"f")!==void 0?u(this,Te,"f"):(w(this,Te,Ai(u(this,te,"f").params,e)),u(this,Te,"f"))};async function Ai(s,e=s.messages.at(-1)){if(!e||e.role!=="assistant"||!e.content||typeof e.content=="string")return null;const t=e.content.filter(r=>r.type==="tool_use");return t.length===0?null:{role:"user",content:await Promise.all(t.map(async r=>{const n=s.tools.find(i=>i.name===r.name);if(!n||!("run"in n))return{type:"tool_result",tool_use_id:r.id,content:`Error: Tool '${r.name}' not found`,is_error:!0};try{let i=r.input;"parse"in n&&n.parse&&(i=n.parse(i));const o=await n.run(i);return{type:"tool_result",tool_use_id:r.id,content:o}}catch(i){return{type:"tool_result",tool_use_id:r.id,content:`Error: ${i instanceof Error?i.message:String(i)}`,is_error:!0}}}))}}const ia={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-5-sonnet-20241022":"October 22, 2025","claude-3-5-sonnet-20240620":"October 22, 2025"};let Yt=class extends Ae{constructor(){super(...arguments),this.batches=new Qa(this._client)}create(e,t){const{betas:a,...r}=e;r.model in ia&&console.warn(`The model '${r.model}' is deprecated and will reach end-of-life on ${ia[r.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let n=this._client._options.timeout;if(!r.stream&&n==null){const i=Ga[r.model]??void 0;n=this._client.calculateNonstreamingTimeout(r.max_tokens,i)}return this._client.post("/v1/messages?beta=true",{body:r,timeout:n??6e5,...t,headers:L([{...a?.toString()!=null?{"anthropic-beta":a?.toString()}:void 0},t?.headers]),stream:e.stream??!1})}stream(e,t){return Jt.createMessage(this,e,t)}countTokens(e,t){const{betas:a,...r}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:r,...t,headers:L([{"anthropic-beta":[...a??[],"token-counting-2024-11-01"].toString()},t?.headers])})}toolRunner(e,t){return new Ka(this._client,e,t)}};Yt.Batches=Qa;Yt.BetaToolRunner=Ka;class _t extends Ae{constructor(){super(...arguments),this.models=new Ja(this._client),this.messages=new Yt(this._client),this.files=new $a(this._client)}}_t.Models=Ja;_t.Messages=Yt;_t.Files=$a;class Ya extends Ae{create(e,t){const{betas:a,...r}=e;return this._client.post("/v1/complete",{body:r,timeout:this._client._options.timeout??6e5,...t,headers:L([{...a?.toString()!=null?{"anthropic-beta":a?.toString()}:void 0},t?.headers]),stream:e.stream??!1})}}var ie,Oe,nt,qt,it,ot,Ot,lt,ke,ct,Dt,Lt,He,zt,Bt,ds,oa,ps,hs,fs,ms,la;const ca="__json_buf";function ua(s){return s.type==="tool_use"||s.type==="server_tool_use"}class Qt{constructor(){ie.add(this),this.messages=[],this.receivedMessages=[],Oe.set(this,void 0),this.controller=new AbortController,nt.set(this,void 0),qt.set(this,()=>{}),it.set(this,()=>{}),ot.set(this,void 0),Ot.set(this,()=>{}),lt.set(this,()=>{}),ke.set(this,{}),ct.set(this,!1),Dt.set(this,!1),Lt.set(this,!1),He.set(this,!1),zt.set(this,void 0),Bt.set(this,void 0),ps.set(this,e=>{if(w(this,Dt,!0),gt(e)&&(e=new pe),e instanceof pe)return w(this,Lt,!0),this._emit("abort",e);if(e instanceof R)return this._emit("error",e);if(e instanceof Error){const t=new R(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new R(String(e)))}),w(this,nt,new Promise((e,t)=>{w(this,qt,e,"f"),w(this,it,t,"f")})),w(this,ot,new Promise((e,t)=>{w(this,Ot,e,"f"),w(this,lt,t,"f")})),u(this,nt,"f").catch(()=>{}),u(this,ot,"f").catch(()=>{})}get response(){return u(this,zt,"f")}get request_id(){return u(this,Bt,"f")}async withResponse(){const e=await u(this,nt,"f");if(!e)throw new Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){const t=new Qt;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,a){const r=new Qt;for(const n of t.messages)r._addMessageParam(n);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...a,headers:{...a?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},u(this,ps,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,a){const r=a?.signal;let n;r&&(r.aborted&&this.controller.abort(),n=this.controller.abort.bind(this.controller),r.addEventListener("abort",n));try{u(this,ie,"m",hs).call(this);const{response:i,data:o}=await e.create({...t,stream:!0},{...a,signal:this.controller.signal}).withResponse();this._connected(i);for await(const l of o)u(this,ie,"m",fs).call(this,l);if(o.controller.signal?.aborted)throw new pe;u(this,ie,"m",ms).call(this)}finally{r&&n&&r.removeEventListener("abort",n)}}_connected(e){this.ended||(w(this,zt,e),w(this,Bt,e?.headers.get("request-id")),u(this,qt,"f").call(this,e),this._emit("connect"))}get ended(){return u(this,ct,"f")}get errored(){return u(this,Dt,"f")}get aborted(){return u(this,Lt,"f")}abort(){this.controller.abort()}on(e,t){return(u(this,ke,"f")[e]||(u(this,ke,"f")[e]=[])).push({listener:t}),this}off(e,t){const a=u(this,ke,"f")[e];if(!a)return this;const r=a.findIndex(n=>n.listener===t);return r>=0&&a.splice(r,1),this}once(e,t){return(u(this,ke,"f")[e]||(u(this,ke,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,a)=>{w(this,He,!0),e!=="error"&&this.once("error",a),this.once(e,t)})}async done(){w(this,He,!0),await u(this,ot,"f")}get currentMessage(){return u(this,Oe,"f")}async finalMessage(){return await this.done(),u(this,ie,"m",ds).call(this)}async finalText(){return await this.done(),u(this,ie,"m",oa).call(this)}_emit(e,...t){if(u(this,ct,"f"))return;e==="end"&&(w(this,ct,!0),u(this,Ot,"f").call(this));const a=u(this,ke,"f")[e];if(a&&(u(this,ke,"f")[e]=a.filter(r=>!r.once),a.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!u(this,He,"f")&&!a?.length&&Promise.reject(r),u(this,it,"f").call(this,r),u(this,lt,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!u(this,He,"f")&&!a?.length&&Promise.reject(r),u(this,it,"f").call(this,r),u(this,lt,"f").call(this,r),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",u(this,ie,"m",ds).call(this))}async _fromReadableStream(e,t){const a=t?.signal;let r;a&&(a.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),a.addEventListener("abort",r));try{u(this,ie,"m",hs).call(this),this._connected(null);const n=ye.fromReadableStream(e,this.controller);for await(const i of n)u(this,ie,"m",fs).call(this,i);if(n.controller.signal?.aborted)throw new pe;u(this,ie,"m",ms).call(this)}finally{a&&r&&a.removeEventListener("abort",r)}}[(Oe=new WeakMap,nt=new WeakMap,qt=new WeakMap,it=new WeakMap,ot=new WeakMap,Ot=new WeakMap,lt=new WeakMap,ke=new WeakMap,ct=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,He=new WeakMap,zt=new WeakMap,Bt=new WeakMap,ps=new WeakMap,ie=new WeakSet,ds=function(){if(this.receivedMessages.length===0)throw new R("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},oa=function(){if(this.receivedMessages.length===0)throw new R("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(a=>a.type==="text").map(a=>a.text);if(t.length===0)throw new R("stream ended without producing a content block with type=text");return t.join(" ")},hs=function(){this.ended||w(this,Oe,void 0)},fs=function(t){if(this.ended)return;const a=u(this,ie,"m",la).call(this,t);switch(this._emit("streamEvent",t,a),t.type){case"content_block_delta":{const r=a.content.at(-1);switch(t.delta.type){case"text_delta":{r.type==="text"&&this._emit("text",t.delta.text,r.text||"");break}case"citations_delta":{r.type==="text"&&this._emit("citation",t.delta.citation,r.citations??[]);break}case"input_json_delta":{ua(r)&&r.input&&this._emit("inputJson",t.delta.partial_json,r.input);break}case"thinking_delta":{r.type==="thinking"&&this._emit("thinking",t.delta.thinking,r.thinking);break}case"signature_delta":{r.type==="thinking"&&this._emit("signature",r.signature);break}default:t.delta}break}case"message_stop":{this._addMessageParam(a),this._addMessage(a,!0);break}case"content_block_stop":{this._emit("contentBlock",a.content.at(-1));break}case"message_start":{w(this,Oe,a);break}}},ms=function(){if(this.ended)throw new R("stream has ended, this shouldn't happen");const t=u(this,Oe,"f");if(!t)throw new R("request ended without sending any chunks");return w(this,Oe,void 0),t},la=function(t){let a=u(this,Oe,"f");if(t.type==="message_start"){if(a)throw new R(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!a)throw new R(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return a;case"message_delta":return a.stop_reason=t.delta.stop_reason,a.stop_sequence=t.delta.stop_sequence,a.usage.output_tokens=t.usage.output_tokens,t.usage.input_tokens!=null&&(a.usage.input_tokens=t.usage.input_tokens),t.usage.cache_creation_input_tokens!=null&&(a.usage.cache_creation_input_tokens=t.usage.cache_creation_input_tokens),t.usage.cache_read_input_tokens!=null&&(a.usage.cache_read_input_tokens=t.usage.cache_read_input_tokens),t.usage.server_tool_use!=null&&(a.usage.server_tool_use=t.usage.server_tool_use),a;case"content_block_start":return a.content.push({...t.content_block}),a;case"content_block_delta":{const r=a.content.at(t.index);switch(t.delta.type){case"text_delta":{r?.type==="text"&&(a.content[t.index]={...r,text:(r.text||"")+t.delta.text});break}case"citations_delta":{r?.type==="text"&&(a.content[t.index]={...r,citations:[...r.citations??[],t.delta.citation]});break}case"input_json_delta":{if(r&&ua(r)){let n=r[ca]||"";n+=t.delta.partial_json;const i={...r};Object.defineProperty(i,ca,{value:n,enumerable:!1,writable:!0}),n&&(i.input=Xa(n)),a.content[t.index]=i}break}case"thinking_delta":{r?.type==="thinking"&&(a.content[t.index]={...r,thinking:r.thinking+t.delta.thinking});break}case"signature_delta":{r?.type==="thinking"&&(a.content[t.index]={...r,signature:t.delta.signature});break}default:t.delta}return a}case"content_block_stop":return a}},Symbol.asyncIterator)](){const e=[],t=[];let a=!1;return this.on("streamEvent",r=>{const n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{a=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{a=!0;for(const n of t)n.reject(r);t.length=0}),this.on("error",r=>{a=!0;for(const n of t)n.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:a?{value:void 0,done:!0}:new Promise((n,i)=>t.push({resolve:n,reject:i})).then(n=>n?{value:n,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ye(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Za extends Ae{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(fe`/v1/messages/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/v1/messages/batches",wt,{query:e,...t})}delete(e,t){return this._client.delete(fe`/v1/messages/batches/${e}`,t)}cancel(e,t){return this._client.post(fe`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const a=await this.retrieve(e);if(!a.results_url)throw new R(`No batch \`results_url\`; Has it finished processing? ${a.processing_status} - ${a.id}`);return this._client.get(a.results_url,{...t,headers:L([{Accept:"application/binary"},t?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((r,n)=>Kt.fromResponse(n.response,n.controller))}}class Is extends Ae{constructor(){super(...arguments),this.batches=new Za(this._client)}create(e,t){e.model in da&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${da[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let a=this._client._options.timeout;if(!e.stream&&a==null){const r=Ga[e.model]??void 0;a=this._client.calculateNonstreamingTimeout(e.max_tokens,r)}return this._client.post("/v1/messages",{body:e,timeout:a??6e5,...t,stream:e.stream??!1})}stream(e,t){return Qt.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const da={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-5-sonnet-20241022":"October 22, 2025","claude-3-5-sonnet-20240620":"October 22, 2025"};Is.Batches=Za;class er extends Ae{retrieve(e,t={},a){const{betas:r}=t??{};return this._client.get(fe`/v1/models/${e}`,{...a,headers:L([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},a?.headers])})}list(e={},t){const{betas:a,...r}=e??{};return this._client.getAPIList("/v1/models",wt,{query:r,...t,headers:L([{...a?.toString()!=null?{"anthropic-beta":a?.toString()}:void 0},t?.headers])})}}var Ii={};const Wt=s=>{if(typeof globalThis.process<"u")return Ii?.[s]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(s)?.trim()};var Ts,Cs,Ft,tr;const Ci="\\n\\nHuman:",Ni="\\n\\nAssistant:";class V{constructor({baseURL:e=Wt("ANTHROPIC_BASE_URL"),apiKey:t=Wt("ANTHROPIC_API_KEY")??null,authToken:a=Wt("ANTHROPIC_AUTH_TOKEN")??null,...r}={}){Ts.add(this),Ft.set(this,void 0);const n={apiKey:t,authToken:a,...r,baseURL:e||"https://api.anthropic.com"};if(!n.dangerouslyAllowBrowser&&ei())throw new R(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);this.baseURL=n.baseURL,this.timeout=n.timeout??Cs.DEFAULT_TIMEOUT,this.logger=n.logger??console;const i="warn";this.logLevel=i,this.logLevel=Ks(n.logLevel,"ClientOptions.logLevel",this)??Ks(Wt("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??i,this.fetchOptions=n.fetchOptions,this.maxRetries=n.maxRetries??2,this.fetch=n.fetch??ni(),w(this,Ft,oi),this._options=n,this.apiKey=t,this.authToken=a}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(this.apiKey&&e.get("x-api-key"))&&!t.has("x-api-key")&&!(this.authToken&&e.get("authorization"))&&!t.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(e){return L([await this.apiKeyAuth(e),await this.bearerAuth(e)])}async apiKeyAuth(e){if(this.apiKey!=null)return L([{"X-Api-Key":this.apiKey}])}async bearerAuth(e){if(this.authToken!=null)return L([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(e){return Object.entries(e).filter(([t,a])=>typeof a<"u").map(([t,a])=>{if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(a)}`;if(a===null)return`${encodeURIComponent(t)}=`;throw new R(`Cannot stringify type ${typeof a}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Je}`}defaultIdempotencyKey(){return`stainless-node-retry-${Ea()}`}makeStatusError(e,t,a,r){return X.generate(e,t,a,r)}buildURL(e,t,a){const r=!u(this,Ts,"m",tr).call(this)&&a||this.baseURL,n=Xn(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return Gn(i)||(t={...i,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new R("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 600*1e3}async prepareOptions(e){}async prepareRequest(e,{url:t,options:a}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,a){return this.request(Promise.resolve(a).then(r=>({method:e,path:t,...r})))}request(e,t=null){return new Gt(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,a){const r=await e,n=r.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=await this.buildRequest(r,{retryCount:n-t});await this.prepareRequest(i,{url:o,options:r});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=a===void 0?"":`, retryOf: ${a}`,_=Date.now();if(K(this).debug(`[${h}] sending request`,We({retryOfRequestLogID:a,method:r.method,url:o,options:r,headers:i.headers})),r.signal?.aborted)throw new pe;const x=new AbortController,v=await this.fetchWithTimeout(o,i,l,x).catch(ws),k=Date.now();if(v instanceof globalThis.Error){const g=`retrying, ${t} attempts remaining`;if(r.signal?.aborted)throw new pe;const y=gt(v)||/timed? ?out/i.test(String(v)+("cause"in v?String(v.cause):""));if(t)return K(this).info(`[${h}] connection ${y?"timed out":"failed"} - ${g}`),K(this).debug(`[${h}] connection ${y?"timed out":"failed"} (${g})`,We({retryOfRequestLogID:a,url:o,durationMs:k-_,message:v.message})),this.retryRequest(r,t,a??h);throw K(this).info(`[${h}] connection ${y?"timed out":"failed"} - error; no more retries left`),K(this).debug(`[${h}] connection ${y?"timed out":"failed"} (error; no more retries left)`,We({retryOfRequestLogID:a,url:o,durationMs:k-_,message:v.message})),y?new Pa:new Xt({cause:v})}const S=[...v.headers.entries()].filter(([g])=>g==="request-id").map(([g,y])=>", "+g+": "+JSON.stringify(y)).join(""),p=`[${h}${f}${S}] ${i.method} ${o} ${v.ok?"succeeded":"failed"} with status ${v.status} in ${k-_}ms`;if(!v.ok){const g=await this.shouldRetry(v);if(t&&g){const N=`retrying, ${t} attempts remaining`;return await ii(v.body),K(this).info(`${p} - ${N}`),K(this).debug(`[${h}] response error (${N})`,We({retryOfRequestLogID:a,url:v.url,status:v.status,headers:v.headers,durationMs:k-_})),this.retryRequest(r,t,a??h,v.headers)}const y=g?"error; no more retries left":"error; not retryable";K(this).info(`${p} - ${y}`);const I=await v.text().catch(N=>ws(N).message),C=Oa(I),E=C?void 0:I;throw K(this).debug(`[${h}] response error (${y})`,We({retryOfRequestLogID:a,url:v.url,status:v.status,headers:v.headers,message:E,durationMs:Date.now()-_})),this.makeStatusError(v.status,C,E,v.headers)}return K(this).info(p),K(this).debug(`[${h}] response start`,We({retryOfRequestLogID:a,url:v.url,status:v.status,headers:v.headers,durationMs:k-_})),{response:v,options:r,controller:x,requestLogID:h,retryOfRequestLogID:a,startTime:_}}getAPIList(e,t,a){return this.requestAPIList(t,{method:"get",path:e,...a})}requestAPIList(e,t){const a=this.makeRequest(t,null,void 0);return new vi(this,a,e)}async fetchWithTimeout(e,t,a,r){const{signal:n,method:i,...o}=t||{};n&&n.addEventListener("abort",()=>r.abort());const l=setTimeout(()=>r.abort(),a),h=globalThis.ReadableStream&&o.body instanceof globalThis.ReadableStream||typeof o.body=="object"&&o.body!==null&&Symbol.asyncIterator in o.body,f={signal:r.signal,...h?{duplex:"half"}:{},method:"GET",...o};i&&(f.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,f)}finally{clearTimeout(l)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,a,r){let n;const i=r?.get("retry-after-ms");if(i){const l=parseFloat(i);Number.isNaN(l)||(n=l)}const o=r?.get("retry-after");if(o&&!n){const l=parseFloat(o);Number.isNaN(l)?n=Date.parse(o)-Date.now():n=l*1e3}if(!(n&&0<=n&&n<60*1e3)){const l=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,l)}return await Zn(n),this.makeRequest(e,t-1,a)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e,i=Math.min(.5*Math.pow(2,n),8),o=1-Math.random()*.25;return i*o*1e3}calculateNonstreamingTimeout(e,t){if(36e5*e/128e3>6e5||t!=null&&e>t)throw new R("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(e,{retryCount:t=0}={}){const a={...e},{method:r,path:n,query:i,defaultBaseURL:o}=a,l=this.buildURL(n,i,o);"timeout"in a&&Yn("timeout",a.timeout),a.timeout=a.timeout??this.timeout;const{bodyHeaders:h,body:f}=this.buildBody({options:a}),_=await this.buildHeaders({options:e,method:r,bodyHeaders:h,retryCount:t});return{req:{method:r,headers:_,...a.signal&&{signal:a.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...a.fetchOptions??{}},url:l,timeout:a.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:a,retryCount:r}){let n={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),n[this.idempotencyHeader]=e.idempotencyKey);const i=L([n,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...ri(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(e),this._options.defaultHeaders,a,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const a=L([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&a.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:La(e)}:u(this,Ft,"f").call(this,{body:e,headers:a})}}Cs=V,Ft=new WeakMap,Ts=new WeakSet,tr=function(){return this.baseURL!=="https://api.anthropic.com"};V.Anthropic=Cs;V.HUMAN_PROMPT=Ci;V.AI_PROMPT=Ni;V.DEFAULT_TIMEOUT=6e5;V.AnthropicError=R;V.APIError=X;V.APIConnectionError=Xt;V.APIConnectionTimeoutError=Pa;V.APIUserAbortError=pe;V.NotFoundError=Aa;V.ConflictError=Ia;V.RateLimitError=Na;V.BadRequestError=Ra;V.AuthenticationError=Ma;V.InternalServerError=qa;V.PermissionDeniedError=ja;V.UnprocessableEntityError=Ca;V.toFile=Si;class xt extends V{constructor(){super(...arguments),this.completions=new Ya(this),this.messages=new Is(this),this.models=new er(this),this.beta=new _t(this)}}xt.Completions=Ya;xt.Messages=Is;xt.Models=er;xt.Beta=_t;const qi={beginner:{tenses:"present simple, present continuous, going to (future), simple past",wordRange:"4-7 words",distractors:"2-3 distractors"},intermediate:{tenses:"present perfect, past continuous, will future, first conditional, modals (can, must, should)",wordRange:"5-9 words",distractors:"3-4 distractors"},advanced:{tenses:"past perfect, third conditional, passive voice, reported speech, subjunctive",wordRange:"6-12 words",distractors:"4-6 distractors"}};function gs(s){return s[Math.floor(Math.random()*s.length)]}const Oi=["I","you","he","she","we","they","my friend","the students","my parents","the dog","our teacher","the children"],Di={"dev meetings & scrum":["the team","the developer","the scrum master","the product owner","we","the QA engineer","the tech lead","the intern","the backend team","the designer"],"software engineering":["the developer","the architect","we","the API","the server","the database","the frontend","the microservice","the application","the system","the engineer","the DevOps team"]},Li={"dev meetings & scrum":"Use vocabulary related to agile/scrum and dev team workflows. Examples include standup, sprint, backlog, blocker, retrospective, code review, deploy, pull request, ticket, demo, velocity, release, branch, merge â€” but feel free to use any other related vocabulary.","software engineering":"Use vocabulary related to software development and infrastructure. Examples include API, database, server, cloud, Docker, cache, endpoint, query, schema, microservice, pipeline, authentication, deployment â€” but feel free to use any other related vocabulary."};function zi(s,e="random",t,a=[],r){const n=qi[s],i=n.tenses.split(", "),o=t||gs(i),l=e==="random"?gs(Xr):e,h=Di[l]||Oi,f=gs(h),_=Li[l]||"",x=Math.floor(Math.random()*1e5),v=a.length>0?`
DO NOT generate any of these sentences (or similar ones):
${a.map(k=>`- "${k}"`).join(`
`)}
You MUST create a completely different sentence with a different subject, verb, and complement.
`:"";return`You are a grammar exercise generator for English learners. Generate ONE exercise.

DIFFICULTY: ${s}
TENSE TO USE: ${o}
TOPIC: ${l}${_?`
TOPIC VOCABULARY: ${_}`:""}
SENTENCE LENGTH: ${n.wordRange}
DISTRACTORS: ${n.distractors}
SUGGESTED SUBJECT: ${f} (use this or a similar subject)
SEED: ${x}${r?`
SENTENCE TYPE: INTERROGATIVE (you MUST generate a question, not a statement)`:""}
${v}

INSTRUCTIONS:
1. Use the specified tense and topic above. Be creative and generate a unique sentence.
2. FIRST write the correct English sentence (correctSentence). This is the source of truth for the entire exercise.
3. THEN write "spanishSentence": the full, natural Spanish translation of correctSentence. This must be a complete, grammatically correct sentence in Spanish (not a list of hints).
4. THEN create conceptual hints ENTIRELY IN SPANISH that describe ONLY what is in the correctSentence:
   - Sujeto: describe the subject in Spanish (e.g., "ella", "mis padres", "un perro")
   - Verbo: the verb in Spanish infinitive (e.g., "cocinar", "ir", "estudiar")
     MODAL VERBS RULE: When the sentence uses a modal verb, DO NOT just say "poder". Be specific:
     - can â†’ "poder (habilidad)"
     - could â†’ "podrÃ­a (posibilidad/pasado)"
     - should â†’ "deberÃ­a (consejo)"
     - must â†’ "deber (obligaciÃ³n)"
     - might â†’ "podrÃ­a/quizÃ¡s (posibilidad)"
     - may â†’ "poder (permiso/posibilidad)"
     Always include the main verb too, e.g., "deberÃ­a (consejo) + enviar", "poder (habilidad) + nadar"
   - Complemento: describe the complement in Spanish (e.g., "en el parque", "una carta", "con sus amigos")
   - Tiempo: time expression in Spanish (e.g., "ayer", "todos los dÃ­as", "ahora mismo")
   NEVER use English words in the hints â€” EXCEPT for technical jargon that developers use in Spanish without translating (e.g., "pull request", "sprint", "deploy", "bug", "backlog", "standup", "branch", "merge", "pipeline", "scrum master"). These terms should stay in English in the hints because that's how Spanish speakers actually use them.
5. Break the correctSentence into individual word cards (one card per word).
6. Add ${n.distractors} that are plausible wrong choices.

CRITICAL CONSISTENCY RULE:
- The hints MUST describe EXACTLY the correctSentence â€” nothing more, nothing less.
- Every concept mentioned in the hints MUST have corresponding words in correctSentence.
- Example of WRONG: hints say "Complemento: en el gimnasio" but correctSentence is "My sister is going to exercise" (missing "at the gym").
- Example of CORRECT: hints say "Complemento: en el gimnasio" and correctSentence is "My sister is going to exercise at the gym".
- There must be exactly one card per word in correctSentence with isDistractor: false.

OTHER RULES:
- Each card has exactly ONE word (never two words in one card)
- No punctuation in card text (no periods, commas, etc.)
- NO duplicate words across cards. If a distractor would duplicate an existing card, pick a different distractor.
- The first word of the correct sentence should be capitalized
- Distractors should be tricky but fair (e.g., "goed" instead of "went", "in" instead of "at")
- Vary between affirmative, negative, and interrogative (question) sentences
- For questions, use proper English question word order (auxiliary + subject + verb, or question word + auxiliary + subject + verb). Do NOT include question marks in cards.

Respond ONLY with valid JSON in this exact format, no markdown:
{
  "hints": ["Sujeto: ...", "Verbo: ...", "Complemento: ...", "Tiempo: ..."],
  "hintDisplay": "Sujeto: ... / Verbo: ... / Complemento: ... / Tiempo: ...",
  "spanishSentence": "La oraciÃ³n completa en espaÃ±ol, natural y correcta",
  "correctSentence": "The full correct sentence",
  "cards": [
    {"id": "d1", "text": "distractor", "isDistractor": true},
    {"id": "c3", "text": "word3", "isDistractor": false},
    {"id": "c1", "text": "word1", "isDistractor": false},
    {"id": "c2", "text": "word2", "isDistractor": false}
  ],
  "metadata": {
    "tense": "present simple",
    "isNegative": false,
    "isQuestion": false,
    "difficulty": "${s}",
    "topic": "daily routine"
  }
}

Use unique IDs like c1, c2... for correct words and d1, d2... for distractors. Remember: cards MUST be shuffled, not in sentence order.`}function Bi(s,e,t,a){return`You are an English grammar evaluator for Spanish-speaking learners.

CONTEXT:
- Grammar: ${e.tense}, ${e.isNegative?"negative":"affirmative"}
- Topic: ${e.topic}
- Difficulty: ${e.difficulty}
- Expected answer: "${t}"
- Student's answer: "${a}"

INSTRUCTIONS:
1. Compare the student's answer ONLY with the expected answer. The expected answer is the ONLY correct reference â€” do not use the hints to judge correctness.
2. The answer is CORRECT if it conveys the same meaning with valid grammar, even if word order differs slightly or uses valid synonyms (e.g., "do not" vs "don't").
3. If incorrect, explain WHY in Spanish in a friendly, educational way.
4. Always include a brief grammar note in Spanish explaining the rule used.
5. The "correctSentence" field in your response MUST be exactly: "${t}" â€” do not modify it.

Respond ONLY with valid JSON in this exact format, no markdown:
{
  "isCorrect": true,
  "feedback": "Brief feedback message in Spanish",
  "correctSentence": "${t}",
  "grammarNote": "Grammar explanation in Spanish about the tense/structure used"
}`}function sr(s){return new xt({apiKey:s,dangerouslyAllowBrowser:!0})}function ar(s){const e=s.match(/```(?:json)?\s*([\s\S]*?)```/);return e?e[1].trim():s.trim()}function Wi(s){return s.replace(/[.,!?;:]+$/g,"").trim().split(/\s+/).map(e=>e.replace(/[.,!?;:]+$/,"").trim()).filter(Boolean)}function Ui(s,e){const t=e.replace(/[.,!?;:]+/g,"").split(/\s+/).filter(Boolean),a=t.map((l,h)=>({id:`c${h+1}`,text:l,isDistractor:!1})),r=new Set(t.map(l=>l.toLowerCase())),n=[],i=new Set;let o=1;for(const l of s){if(!l.isDistractor)continue;const h=Wi(l.text);for(const f of h){const _=f.toLowerCase();i.has(_)||r.has(_)||(i.add(_),n.push({id:`d${o++}`,text:f,isDistractor:!0}))}}return[...a,...n]}function Vi(s){const e=[...s];for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e}async function rr(s,e,t="random",a,r=[],n){const i=sr(s),o=zi(e,t,a,r,n),h=(await i.messages.create({model:"claude-haiku-4-5-20251001",max_tokens:1024,messages:[{role:"user",content:o}]})).content[0];if(h.type!=="text")throw new Error("Unexpected response type");const f=JSON.parse(ar(h.text));return f.cards=Ui(f.cards,f.correctSentence),f.metadata.isQuestion&&(f.cards.push({id:"qm",text:"?",isDistractor:!1}),f.correctSentence=f.correctSentence.replace(/\?$/,"").trim()+" ?"),f.cards=Vi(f.cards),f}async function Fi(s,e,t,a,r){const n=sr(s),i=Bi(e,t,a,r),l=(await n.messages.create({model:"claude-haiku-4-5-20251001",max_tokens:512,messages:[{role:"user",content:i}]})).content[0];if(l.type!=="text")throw new Error("Unexpected response type");return JSON.parse(ar(l.text))}let Be=null;function kt(){return Be||(Be=new AudioContext),Be.state==="suspended"&&Be.resume(),Be}function ut(s,e,t="sine",a=.15){const r=kt(),n=r.createOscillator(),i=r.createGain();n.type=t,n.frequency.value=s,i.gain.setValueAtTime(a,r.currentTime),i.gain.exponentialRampToValueAtTime(.001,r.currentTime+e),n.connect(i),i.connect(r.destination),n.start(r.currentTime),n.stop(r.currentTime+e)}function Hi(){const s=kt(),e=s.createOscillator(),t=s.createGain();e.type="sine",e.frequency.setValueAtTime(600,s.currentTime),e.frequency.exponentialRampToValueAtTime(900,s.currentTime+.06),t.gain.setValueAtTime(.12,s.currentTime),t.gain.exponentialRampToValueAtTime(.001,s.currentTime+.1),e.connect(t),t.connect(s.destination),e.start(s.currentTime),e.stop(s.currentTime+.1)}function $i(){const s=kt(),e=s.createOscillator(),t=s.createGain();e.type="sine",e.frequency.setValueAtTime(800,s.currentTime),e.frequency.exponentialRampToValueAtTime(500,s.currentTime+.08),t.gain.setValueAtTime(.1,s.currentTime),t.gain.exponentialRampToValueAtTime(.001,s.currentTime+.1),e.connect(t),t.connect(s.destination),e.start(s.currentTime),e.stop(s.currentTime+.1)}function Ji(){kt().currentTime,ut(523,.15,"sine",.15),setTimeout(()=>ut(659,.15,"sine",.15),100),setTimeout(()=>ut(784,.15,"sine",.15),200),setTimeout(()=>ut(1047,.3,"sine",.18),300),setTimeout(()=>ut(1319,.4,"triangle",.08),400)}function Qi(){const s=kt(),e=s.createOscillator(),t=s.createGain();e.type="sawtooth",e.frequency.setValueAtTime(350,s.currentTime),e.frequency.linearRampToValueAtTime(300,s.currentTime+.2),e.frequency.linearRampToValueAtTime(250,s.currentTime+.5),e.frequency.linearRampToValueAtTime(180,s.currentTime+.8),t.gain.setValueAtTime(.1,s.currentTime),t.gain.setValueAtTime(.1,s.currentTime+.15),t.gain.linearRampToValueAtTime(.03,s.currentTime+.25),t.gain.linearRampToValueAtTime(.1,s.currentTime+.35),t.gain.linearRampToValueAtTime(.03,s.currentTime+.5),t.gain.linearRampToValueAtTime(.08,s.currentTime+.6),t.gain.exponentialRampToValueAtTime(.001,s.currentTime+.9),e.connect(t),t.connect(s.destination),e.start(s.currentTime),e.stop(s.currentTime+.9)}var Xi=j('<!> <div class="actions svelte-9e286u"><button class="clear-btn svelte-9e286u">Limpiar</button> <button class="submit-btn svelte-9e286u">Verificar</button></div>',1),Gi=j('<div class="loading-eval svelte-9e286u"><p>Evaluando tu respuesta...</p></div>'),Ki=j("<!> <!> <!> <!> <!>",1),Yi=j('<div class="error-msg svelte-9e286u"><p class="svelte-9e286u"> </p> <div class="error-actions svelte-9e286u"><button class="svelte-9e286u">Cerrar</button> <button class="change-key-btn svelte-9e286u">Cambiar API key</button></div></div>'),Zi=j('<div class="game-board svelte-9e286u"><!> <!> <!></div>');function eo(s,e){Re(e,!0);const t=le(jn),a=le(Nn),r=le(xa),n=le(An),i=le(In),o=le(Hn),l=le(Sa),h=le($n);let f=W(!1);function _(E){Hi(),Un(E)}function x(E){$i(),Vn(E)}async function v(){if(!(!c(t)||!c(h).trim())){T(f,!0),be("submitted");try{const E=await Fi(Us(),c(t).hints,c(t).metadata,c(t).correctSentence,c(h));Wn(E),E.isCorrect?Ji():Qi(),be("feedback")}catch(E){Ut(E instanceof Error?E.message:"Error al evaluar"),be("playing")}finally{T(f,!1)}}}async function k(){Ta(),be("loading");try{const E=await rr(Us(),En(),Pn(),Rn(),Cn(),Mn());ka(E),be("playing")}catch(E){Ut(E instanceof Error?E.message:"Error al generar"),be("playing")}}var S=Zi(),p=m(S);Tn(p,{get session(){return c(a)},get onback(){return Jn}});var g=b(p,2);{var y=E=>{var D=Ki(),N=bs(D);hn(N,{get hintDisplay(){return c(t).hintDisplay},get spanishSentence(){return c(t).spanishSentence},get metadata(){return c(t).metadata}});var z=b(N,2);vn(z,{get cards(){return c(l)},ondeselect:x});var F=b(z,2);{var q=H=>{var Z=Xi(),ee=bs(Z);wn(ee,{get cards(){return c(o)},onselect:_});var $=b(ee,2),Q=m($);Q.__click=function(...re){Fn?.apply(this,re)};var me=b(Q,2);me.__click=v,d($),B(()=>{Q.disabled=c(l).length===0,me.disabled=c(l).length===0}),M(H,Z)};J(F,H=>{c(r)==="playing"&&H(q)})}var Y=b(F,2);{var A=H=>{var Z=Gi();M(H,Z)};J(Y,H=>{c(r)==="submitted"&&H(A)})}var O=b(Y,2);{var G=H=>{kn(H,{get result(){return c(n)},onnext:k})};J(O,H=>{c(r)==="feedback"&&c(n)&&H(G)})}M(E,D)};J(g,E=>{c(t)&&E(y)})}var I=b(g,2);{var C=E=>{var D=Yi(),N=m(D),z=m(N,!0);d(N);var F=b(N,2),q=m(F);q.__click=()=>Ut(null);var Y=b(q,2);Y.__click=()=>{localStorage.removeItem("grammar_game_api_key"),location.reload()},d(F),d(D),B(()=>P(z,c(i))),M(E,D)};J(I,E=>{c(i)&&E(C)})}d(S),M(s,S),Me()}je(["click"]);var to=j('<div class="tense-detail svelte-14kz89h"><span class="detail-label svelte-14kz89h">Estructura</span> <p class="detail-text svelte-14kz89h"> </p></div>'),so=j('<th class="svelte-14kz89h"> </th>'),ao=j('<td class="svelte-14kz89h"> </td>'),ro=j('<tr class="svelte-14kz89h"></tr>'),no=j('<details class="table-collapsible svelte-14kz89h"><summary class="table-toggle svelte-14kz89h"> </summary> <div class="table-detail svelte-14kz89h"><table class="verb-table svelte-14kz89h"><thead><tr></tr></thead><tbody class="svelte-14kz89h"></tbody></table></div></details>'),io=j('<details class="tense-card svelte-14kz89h"><summary class="tense-name svelte-14kz89h"> </summary> <div class="tense-content svelte-14kz89h"><p class="tense-desc svelte-14kz89h"> </p> <!> <div class="tense-detail example svelte-14kz89h"><span class="detail-label svelte-14kz89h">Ejemplo</span> <p class="detail-text svelte-14kz89h"> </p> <p class="detail-text-es svelte-14kz89h"> </p></div> <div class="tense-detail tip svelte-14kz89h"><span class="detail-label svelte-14kz89h">Tip</span> <p class="detail-text svelte-14kz89h"> </p></div> <!></div></details>'),oo=j('<div class="section svelte-14kz89h"><h3 class="section-title svelte-14kz89h"> </h3> <!></div>'),lo=j('<div class="glossary svelte-14kz89h"><div class="glossary-header svelte-14kz89h"><button class="close-btn svelte-14kz89h" aria-label="Cerrar glosario"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg></button> <h2 class="glossary-title svelte-14kz89h">Glosario gramatical</h2></div> <!></div>');function co(s,e){const t={Fundamentos:"#6b7280",Principiante:"#e85d04",Intermedio:"#e85d04",Avanzado:"#d00000",Preguntas:"#1a56db"};var a=lo(),r=m(a),n=m(r);n.__click=function(...o){e.onclose?.apply(this,o)},Pe(2),d(r);var i=b(r,2);de(i,17,()=>mt,Se,(o,l)=>{var h=oo(),f=m(h),_=m(f,!0);d(f);var x=b(f,2);de(x,17,()=>c(l).tenses,Se,(v,k)=>{var S=io(),p=m(S),g=m(p,!0);d(p);var y=b(p,2),I=m(y),C=m(I,!0);d(I);var E=b(I,2);{var D=ee=>{var $=to(),Q=b(m($),2),me=m(Q,!0);d(Q),d($),B(()=>P(me,c(k).structure)),M(ee,$)};J(E,ee=>{c(k).structure&&ee(D)})}var N=b(E,2),z=b(m(N),2),F=m(z,!0);d(z);var q=b(z,2),Y=m(q,!0);d(q),d(N);var A=b(N,2),O=b(m(A),2),G=m(O,!0);d(O),d(A);var H=b(A,2);{var Z=ee=>{var $=no(),Q=m($),me=m(Q);d(Q);var re=b(Q,2),ge=m(re),Le=m(ge),Ie=m(Le);de(Ie,21,()=>c(k).table.headers,Se,(we,_e)=>{var oe=so(),Zt=m(oe,!0);d(oe),B(()=>P(Zt,c(_e))),M(we,oe)}),d(Ie),d(Le);var Ue=b(Le);de(Ue,21,()=>c(k).table.rows,Se,(we,_e)=>{var oe=ro();de(oe,21,()=>c(_e),Se,(Zt,nr)=>{var es=ao(),ir=m(es,!0);d(es),B(()=>P(ir,c(nr))),M(Zt,es)}),d(oe),M(we,oe)}),d(Ue),d(ge),d(re),d($),B(()=>P(me,`Ver lista completa (${c(k).table.rows.length??""} verbos)`)),M(ee,$)};J(H,ee=>{c(k).table&&ee(Z)})}d(y),d(S),B(()=>{P(g,c(k).name),P(C,c(k).description),P(F,c(k).example),P(Y,c(k).exampleEs),P(G,c(k).tip)}),M(v,S)}),d(h),B(()=>{Vr(f,`color: ${t[c(l).level]??""}`),P(_,c(l).level)}),M(o,h)}),d(a),M(s,a)}je(["click"]);var uo=j(`<div class="dedication svelte-kt5d72"><button class="back-btn svelte-kt5d72"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-kt5d72"><path d="M19 12H5" class="svelte-kt5d72"></path><path d="M12 19l-7-7 7-7" class="svelte-kt5d72"></path></svg></button> <div class="heart-big svelte-kt5d72">ðŸ§¡</div> <h2 class="title svelte-kt5d72">Dedicatoria</h2> <div class="message svelte-kt5d72"><p class="svelte-kt5d72">Dedicado a mis hijos <strong class="svelte-kt5d72">Anaelle</strong> y <strong class="svelte-kt5d72">David</strong>,
			a mis padres <strong class="svelte-kt5d72">Reinaldo</strong> y <strong class="svelte-kt5d72">Nelcy</strong>,
			a mi hermanita <strong class="svelte-kt5d72">Jeje</strong>,
			a toda mi familia <strong class="svelte-kt5d72">Dominguez</strong> y <strong class="svelte-kt5d72">Castiblanco</strong>,
			y por ultimo pero no menos importante,
			a mi bella esposa <strong class="svelte-kt5d72">Olga Lucia</strong>.</p> <p class="svelte-kt5d72">Que este jueguito sea una entretencion sana,
			les ayude a dominar el idioma
			y les mantenga la mente saludable y en forma.</p></div> <div class="decoration svelte-kt5d72"><span class="svelte-kt5d72">~</span> <span class="svelte-kt5d72">ðŸ§¡</span> <span class="svelte-kt5d72">~</span></div> <p class="signature svelte-kt5d72">Con todo mi amor, Diego</p></div>`);function po(s,e){var t=uo(),a=m(t);a.__click=function(...r){e.onclose?.apply(this,r)},Pe(10),d(t),M(s,t)}je(["click"]);var ho=j('<div class="loading-screen svelte-1uha8ag"><div class="spinner svelte-1uha8ag"></div> <p>Generando ejercicio...</p></div>');function ko(s,e){Re(e,!0);const t=le(xa);let a=W(!1),r=W(!1),n=W(!1);cr(()=>{On()&&T(a,!0)});function i(y){qn(y),T(a,!0)}async function o(y,I,C,E){Dn(y),Ln(I),zn(C),Bn(E??!1),Ta(),be("loading");try{const D=await rr(h(),y,I,C,[],E);ka(D),be("playing")}catch(D){Ut(D instanceof Error?D.message:"Error al generar el ejercicio"),be("playing")}}function l(){localStorage.removeItem("grammar_game_api_key"),T(a,!1),be("setup")}function h(){return localStorage.getItem("grammar_game_api_key")??""}var f=lr(),_=bs(f);{var x=y=>{Jr(y,{onsave:i})},v=y=>{co(y,{onclose:()=>T(r,!1)})},k=y=>{po(y,{onclose:()=>T(n,!1)})},S=y=>{tn(y,{onselect:o,onglossary:()=>T(r,!0),ondedication:()=>T(n,!0),onchangekey:l})},p=y=>{var I=ho();M(y,I)},g=y=>{eo(y,{})};J(_,y=>{c(t)==="setup"&&!c(a)?y(x):c(t)==="setup"&&c(a)&&c(r)?y(v,1):c(t)==="setup"&&c(a)&&c(n)?y(k,2):c(t)==="setup"&&c(a)?y(S,3):c(t)==="loading"?y(p,4):y(g,!1)})}M(s,f),Me()}export{ko as component};
